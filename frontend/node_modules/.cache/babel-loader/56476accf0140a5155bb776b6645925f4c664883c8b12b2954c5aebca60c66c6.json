{"ast":null,"code":"import _regeneratorRuntime from \"D:/software_data/Project/Y0527/CODE_BAK/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/software_data/Project/Y0527/CODE_BAK/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.array.is-array.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.date.to-iso-string.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.parse-float.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport * as echarts from 'echarts';\nimport energyEfficiencyApi from '@/api/energyEfficiency';\nimport { formatDateTime, calculateDuration } from '@/utils/dateTime';\nimport { ArrowUp, ArrowDown } from '@element-plus/icons-vue';\nexport default {\n  name: 'EnergyEfficiencyAnalysis',\n  components: {\n    ArrowUp: ArrowUp,\n    ArrowDown: ArrowDown\n  },\n  data: function data() {\n    return {\n      // 固定的默认筛选条件（不再显示在UI上）\n      dateRange: [new Date(new Date().getTime() - 30 * 24 * 60 * 60 * 1000), new Date()],\n      selectedStations: [],\n      selectedRobots: [],\n      // 数据列表\n      stations: [],\n      robots: [],\n      // 图表相关\n      currentChart: 'efficiency',\n      currentChartTitle: '充电效率趋势分析',\n      charts: {\n        efficiency: null,\n        consumption: null,\n        utilization: null,\n        robot: null,\n        peak: null\n      },\n      // KPI数据\n      kpiData: [{\n        title: '平均充电效率',\n        value: 0,\n        unit: '%',\n        change: 0,\n        trend: 'up'\n      }, {\n        title: '总能耗',\n        value: 0,\n        unit: 'kWh',\n        change: 0,\n        trend: 'up'\n      }, {\n        title: '充电器利用率',\n        value: 0,\n        unit: '%',\n        change: 0,\n        trend: 'up'\n      }, {\n        title: '平均等待时间',\n        value: 0,\n        unit: 'min',\n        change: 0,\n        trend: 'down'\n      }, {\n        title: '充电成功率',\n        value: 0,\n        unit: '%',\n        change: 0,\n        trend: 'up'\n      }, {\n        title: '总充电次数',\n        value: 0,\n        unit: '次',\n        change: 0,\n        trend: 'up'\n      }]\n    };\n  },\n  mounted: function mounted() {\n    this.initData();\n  },\n  methods: {\n    initData: function initData() {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var stationsResponse, robotsResponse;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return energyEfficiencyApi.getStations();\n            case 3:\n              stationsResponse = _context.sent;\n              _this.stations = stationsResponse.data;\n\n              // 获取机器人列表\n              _context.next = 7;\n              return energyEfficiencyApi.getRobots();\n            case 7:\n              robotsResponse = _context.sent;\n              _this.robots = robotsResponse.data;\n\n              // 获取初始数据\n              _this.fetchKpiData();\n              _this.fetchChartData();\n              _context.next = 17;\n              break;\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('初始化数据失败:', _context.t0);\n              _this.$message.error('加载数据失败，请重试');\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 13]]);\n      }))();\n    },\n    // 刷新所有数据\n    refreshData: function refreshData() {\n      this.fetchKpiData();\n      this.fetchChartData();\n    },\n    // 获取KPI数据\n    fetchKpiData: function fetchKpiData() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var params, response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              params = _this2.getFilterParams();\n              _context2.next = 4;\n              return energyEfficiencyApi.getKpiData(params);\n            case 4:\n              response = _context2.sent;\n              _this2.kpiData = [{\n                title: '平均充电效率',\n                value: response.data.avgEfficiency.toFixed(2),\n                unit: '%',\n                change: response.data.efficiencyChange.toFixed(2),\n                trend: response.data.efficiencyChange >= 0 ? 'up' : 'down'\n              }, {\n                title: '总能耗',\n                value: response.data.totalEnergy.toFixed(2),\n                unit: 'kWh',\n                change: response.data.energyChange.toFixed(2),\n                trend: response.data.energyChange >= 0 ? 'up' : 'down'\n              }, {\n                title: '充电器利用率',\n                value: response.data.utilization.toFixed(2),\n                unit: '%',\n                change: response.data.utilizationChange.toFixed(2),\n                trend: response.data.utilizationChange >= 0 ? 'up' : 'down'\n              }, {\n                title: '平均等待时间',\n                value: response.data.avgWaitTime.toFixed(2),\n                unit: 'min',\n                change: response.data.waitTimeChange.toFixed(2),\n                trend: response.data.waitTimeChange >= 0 ? 'up' : 'down'\n              }, {\n                title: '充电成功率',\n                value: response.data.successRate.toFixed(2),\n                unit: '%',\n                change: response.data.successRateChange.toFixed(2),\n                trend: response.data.successRateChange >= 0 ? 'up' : 'down'\n              }, {\n                title: '总充电次数',\n                value: response.data.totalOrders || 0,\n                unit: '次',\n                change: response.data.ordersChange || 0,\n                trend: (response.data.ordersChange || 0) >= 0 ? 'up' : 'down'\n              }];\n              _context2.next = 12;\n              break;\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error('获取KPI数据失败:', _context2.t0);\n              _this2.$message.error('获取KPI数据失败');\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 8]]);\n      }))();\n    },\n    // 获取图表数据并渲染\n    fetchChartData: function fetchChartData() {\n      var _this3 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var params;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              params = _this3.getFilterParams(); // 根据当前选择的图表类型获取数据\n              _context3.t0 = _this3.currentChart;\n              _context3.next = _context3.t0 === 'efficiency' ? 5 : _context3.t0 === 'consumption' ? 8 : _context3.t0 === 'utilization' ? 11 : _context3.t0 === 'robot' ? 14 : _context3.t0 === 'peak' ? 17 : 20;\n              break;\n            case 5:\n              _context3.next = 7;\n              return _this3.renderEfficiencyChart(params);\n            case 7:\n              return _context3.abrupt(\"break\", 20);\n            case 8:\n              _context3.next = 10;\n              return _this3.renderConsumptionChart(params);\n            case 10:\n              return _context3.abrupt(\"break\", 20);\n            case 11:\n              _context3.next = 13;\n              return _this3.renderUtilizationChart(params);\n            case 13:\n              return _context3.abrupt(\"break\", 20);\n            case 14:\n              _context3.next = 16;\n              return _this3.renderRobotChart(params);\n            case 16:\n              return _context3.abrupt(\"break\", 20);\n            case 17:\n              _context3.next = 19;\n              return _this3.renderPeakChart(params);\n            case 19:\n              return _context3.abrupt(\"break\", 20);\n            case 20:\n              _context3.next = 26;\n              break;\n            case 22:\n              _context3.prev = 22;\n              _context3.t1 = _context3[\"catch\"](0);\n              console.error('获取图表数据失败:', _context3.t1);\n              _this3.$message.error('获取图表数据失败');\n            case 26:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 22]]);\n      }))();\n    },\n    // 充电效率趋势图\n    renderEfficiencyChart: function renderEfficiencyChart(params) {\n      var _this4 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var response, option;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return energyEfficiencyApi.getEfficiencyTrend(params);\n            case 2:\n              response = _context4.sent;\n              if (!_this4.charts.efficiency) {\n                _this4.charts.efficiency = echarts.init(_this4.$refs.efficiencyChart);\n              }\n              option = {\n                title: {\n                  text: '充电效率趋势分析',\n                  left: 'center',\n                  top: '10px'\n                },\n                tooltip: {\n                  trigger: 'axis'\n                },\n                legend: {\n                  data: response.data.stations.map(function (station) {\n                    return station.name;\n                  }),\n                  selected: response.data.stations.reduce(function (acc, station) {\n                    acc[station.name] = true;\n                    return acc;\n                  }, {}),\n                  top: '40px',\n                  type: 'scroll',\n                  orient: 'horizontal',\n                  selectedMode: false\n                },\n                grid: {\n                  left: '3%',\n                  right: '4%',\n                  bottom: '3%',\n                  top: '100px',\n                  containLabel: true\n                },\n                xAxis: {\n                  type: 'category',\n                  boundaryGap: false,\n                  data: response.data.timeline\n                },\n                yAxis: {\n                  type: 'value',\n                  name: '充电效率 (%)',\n                  min: 50,\n                  max: 100\n                },\n                series: response.data.stations.map(function (station) {\n                  return {\n                    name: station.name,\n                    type: 'line',\n                    data: station.efficiencyData,\n                    smooth: true\n                  };\n                })\n              };\n              _this4.charts.efficiency.setOption(option);\n\n              // 取消图表的点击事件\n              _this4.charts.efficiency.off('click');\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }))();\n    },\n    // 能耗分布热力图\n    renderConsumptionChart: function renderConsumptionChart(params) {\n      var _this5 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var response, hours, hourRanges, today, days, dayRanges, i, startDate, endDate, startFormatted, endFormatted, fixedMaxValue, dataMap, formattedData, option;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              console.log('获取能耗分布数据，参数:', params);\n              _context5.next = 4;\n              return energyEfficiencyApi.getEnergyConsumptionDistribution(params);\n            case 4:\n              response = _context5.sent;\n              console.log('能耗分布数据响应:', response.data);\n              if (!_this5.charts.consumption) {\n                _this5.charts.consumption = echarts.init(_this5.$refs.consumptionChart);\n              }\n\n              // 检查返回的数据\n              if (!(!response.data || !response.data.days || !response.data.data || response.data.days.length === 0)) {\n                _context5.next = 11;\n                break;\n              }\n              console.error('能耗分布数据异常:', response.data);\n              // 显示一个空的图表\n              _this5.charts.consumption.setOption({\n                title: {\n                  text: '能耗分布热力图 (无数据)',\n                  left: 'center',\n                  top: '10px'\n                },\n                grid: {\n                  height: '70%',\n                  top: '10%'\n                }\n              });\n              return _context5.abrupt(\"return\");\n            case 11:\n              // 定义X轴为每2小时一个刻度，从0到22\n              hours = ['0', '2', '4', '6', '8', '10', '12', '14', '16', '18', '20', '22'];\n              hourRanges = hours.map(function (h) {\n                var start = parseInt(h);\n                var end = start + 1;\n                return {\n                  start: start,\n                  end: end\n                };\n              }); // 计算30天日期范围，每2天一个刻度\n              today = new Date();\n              days = [];\n              dayRanges = [];\n              for (i = 29; i >= 0; i -= 2) {\n                // 当前2天区间的开始日期\n                startDate = new Date(today);\n                startDate.setDate(today.getDate() - i);\n\n                // 当前2天区间的结束日期\n                endDate = new Date(startDate);\n                endDate.setDate(startDate.getDate() + 1);\n\n                // 格式化日期为与API相同的格式 \"YYYY-MM-DD\"\n                startFormatted = startDate.toISOString().split('T')[0];\n                endFormatted = endDate.toISOString().split('T')[0]; // 使用开始日期作为标签\n                days.push(startFormatted);\n\n                // 保存日期范围用于数据聚合\n                dayRanges.push({\n                  start: startFormatted,\n                  end: endFormatted\n                });\n              }\n              console.log('X轴时间段数:', hours.length, 'Y轴日期段数:', days.length, '总格子数:', hours.length * days.length);\n\n              // 使用固定的最大值\n              fixedMaxValue = 120; // 将API返回的数据转换为映射表，便于快速查找\n              dataMap = {};\n              response.data.data.forEach(function (item) {\n                if (Array.isArray(item) && item.length === 3) {\n                  var day = item[0];\n                  var hour = parseInt(item[1]);\n                  var value = parseFloat(item[2] || 0);\n                  if (!isNaN(value) && hour >= 0 && hour < 24) {\n                    if (!dataMap[day]) {\n                      dataMap[day] = {};\n                    }\n                    dataMap[day][hour] = value;\n                  }\n                }\n              });\n\n              // 生成180个格子数据 (12个时间段 * 15个日期段)\n              formattedData = [];\n              dayRanges.forEach(function (dayRange, dayIndex) {\n                hourRanges.forEach(function (hourRange, hourIndex) {\n                  // 计算该格子的平均能耗值\n                  var totalValue = 0;\n                  var count = 0;\n\n                  // 遍历当前日期范围内的所有日期\n                  var startDay = new Date(dayRange.start);\n                  var endDay = new Date(dayRange.end);\n                  for (var d = new Date(startDay); d <= endDay; d.setDate(d.getDate() + 1)) {\n                    var currentDay = d.toISOString().split('T')[0];\n\n                    // 遍历当前时间范围内的所有小时\n                    for (var h = hourRange.start; h <= hourRange.end; h++) {\n                      if (dataMap[currentDay] && dataMap[currentDay][h] !== undefined) {\n                        totalValue += dataMap[currentDay][h];\n                        count++;\n                      }\n                    }\n                  }\n\n                  // 计算平均值，如果没有数据则为0\n                  var avgValue = count > 0 ? totalValue / count : 0;\n\n                  // 添加到格式化数据中 [x索引, y索引, 值]\n                  formattedData.push([hourIndex, dayIndex, avgValue]);\n                });\n              });\n              console.log('格式化后的数据点数:', formattedData.length);\n              console.log('格式化后的数据示例:', formattedData.slice(0, 3));\n\n              // 添加详细调试日志\n              console.log('热力图数据详情:');\n              console.log('- X轴类别数据:', hours);\n              console.log('- Y轴类别数据长度:', days.length);\n              console.log('- 第一个数据点:', formattedData[0]);\n              if (formattedData[0]) {\n                console.log('  - X索引:', formattedData[0][0], '对应值:', hours[formattedData[0][0]]);\n                console.log('  - Y索引:', formattedData[0][1], '对应值:', days[formattedData[0][1]]);\n                console.log('  - 数值:', formattedData[0][2]);\n              }\n              option = {\n                animation: false,\n                // 禁用动画，避免渲染问题\n                title: {\n                  text: '能耗分布热力图',\n                  left: 'center',\n                  top: '10px'\n                },\n                tooltip: {\n                  position: 'top',\n                  formatter: function formatter(params) {\n                    var hourIndex = params.data[0];\n                    var hourStart = hours[hourIndex];\n                    var hourEnd = parseInt(hourStart) + 2;\n                    var dayIndex = params.data[1];\n                    var day = days[dayIndex];\n                    var nextDay = dayRanges[dayIndex].end;\n                    var value = params.data[2];\n                    return \"\\u65F6\\u95F4\\u6BB5: \".concat(hourStart, \":00-\").concat(hourEnd, \":00<br>\\u65E5\\u671F: \").concat(day, \" \\u81F3 \").concat(nextDay, \"<br>\\u80FD\\u8017: \").concat(value.toFixed(2), \" kWh\");\n                  }\n                },\n                grid: {\n                  height: '70%',\n                  top: '60px',\n                  left: '80px',\n                  right: '30px'\n                },\n                xAxis: {\n                  type: 'category',\n                  data: hours,\n                  splitArea: {\n                    show: true\n                  },\n                  axisLabel: {\n                    formatter: '{value}:00'\n                  }\n                },\n                yAxis: {\n                  type: 'category',\n                  data: days,\n                  splitArea: {\n                    show: true\n                  },\n                  axisLabel: {\n                    formatter: function formatter(value) {\n                      // 只显示月和日\n                      var parts = value.split('-');\n                      return parts[1] + '-' + parts[2];\n                    }\n                  }\n                },\n                visualMap: {\n                  type: 'continuous',\n                  min: 0,\n                  max: fixedMaxValue,\n                  calculable: false,\n                  // 禁用拖动调节\n                  realtime: false,\n                  // 禁用实时更新\n                  orient: 'horizontal',\n                  left: 'center',\n                  bottom: '5%',\n                  inRange: {\n                    color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']\n                  },\n                  text: ['高', '低'],\n                  // 两端的文本\n                  itemWidth: 15,\n                  // 图形的宽度\n                  itemHeight: 120,\n                  // 图形的高度\n                  precision: 0 // 数据展示的小数精度\n                },\n                series: [{\n                  name: '能耗 (kWh)',\n                  type: 'heatmap',\n                  data: formattedData,\n                  label: {\n                    show: false\n                  },\n                  emphasis: {\n                    itemStyle: {\n                      shadowBlur: 10,\n                      shadowColor: 'rgba(0, 0, 0, 0.5)'\n                    }\n                  }\n                }]\n              }; // 尝试设置图表选项\n              try {\n                // 完全销毁并重新创建图表实例\n                if (_this5.charts.consumption) {\n                  _this5.charts.consumption.dispose();\n                }\n\n                // 确保DOM元素存在且有尺寸\n                if (_this5.$refs.consumptionChart) {\n                  // 设置明确的宽高\n                  _this5.$refs.consumptionChart.style.width = '100%';\n                  _this5.$refs.consumptionChart.style.height = '500px'; // 增加高度以容纳更多数据\n\n                  // 初始化图表\n                  _this5.charts.consumption = echarts.init(_this5.$refs.consumptionChart);\n\n                  // 强制应用选项\n                  _this5.charts.consumption.setOption(option, true);\n                  console.log('热力图渲染成功');\n\n                  // 强制重绘\n                  _this5.$nextTick(function () {\n                    if (_this5.charts.consumption) {\n                      _this5.charts.consumption.resize();\n                    }\n                  });\n\n                  // 取消图表的点击事件\n                  _this5.charts.consumption.off('click');\n                } else {\n                  console.error('热力图DOM元素不存在');\n                }\n              } catch (chartError) {\n                console.error('设置热力图选项失败:', chartError);\n                console.error('错误详情:', chartError.stack);\n                // 尝试重新创建图表实例\n                if (_this5.$refs.consumptionChart) {\n                  if (_this5.charts.consumption) {\n                    _this5.charts.consumption.dispose();\n                  }\n                  _this5.charts.consumption = echarts.init(_this5.$refs.consumptionChart);\n                  _this5.charts.consumption.setOption({\n                    title: {\n                      text: '能耗分布热力图 (渲染失败)',\n                      textStyle: {\n                        color: '#ff0000'\n                      },\n                      left: 'center',\n                      top: '10px'\n                    }\n                  });\n                }\n              }\n              _context5.next = 39;\n              break;\n            case 34:\n              _context5.prev = 34;\n              _context5.t0 = _context5[\"catch\"](0);\n              console.error('渲染能耗分布热力图失败:', _context5.t0);\n              console.error('错误详情:', _context5.t0.stack);\n              // 显示错误信息\n              if (_this5.charts.consumption) {\n                _this5.charts.consumption.setOption({\n                  title: {\n                    text: '能耗分布热力图 (加载失败)',\n                    textStyle: {\n                      color: '#ff0000'\n                    },\n                    left: 'center',\n                    top: '10px'\n                  }\n                });\n              }\n            case 39:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, null, [[0, 34]]);\n      }))();\n    },\n    // 充电站利用率对比\n    renderUtilizationChart: function renderUtilizationChart(params) {\n      var _this6 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var response, option;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return energyEfficiencyApi.getStationUtilization(params);\n            case 2:\n              response = _context6.sent;\n              if (!_this6.charts.utilization) {\n                _this6.charts.utilization = echarts.init(_this6.$refs.utilizationChart);\n              }\n              option = {\n                title: {\n                  text: '充电站利用率对比'\n                },\n                tooltip: {\n                  trigger: 'axis',\n                  axisPointer: {\n                    type: 'shadow'\n                  }\n                },\n                legend: {\n                  data: ['忙碌时间', '空闲时间', '维护时间', '故障时间'],\n                  selectedMode: false\n                },\n                grid: {\n                  left: '3%',\n                  right: '4%',\n                  bottom: '3%',\n                  containLabel: true\n                },\n                xAxis: {\n                  type: 'value',\n                  name: '小时',\n                  max: 24\n                },\n                yAxis: {\n                  type: 'category',\n                  data: response.data.map(function (item) {\n                    return item.stationName;\n                  })\n                },\n                series: [{\n                  name: '忙碌时间',\n                  type: 'bar',\n                  stack: 'total',\n                  label: {\n                    show: true\n                  },\n                  emphasis: {\n                    focus: 'series'\n                  },\n                  data: response.data.map(function (item) {\n                    return item.busyHours;\n                  })\n                }, {\n                  name: '空闲时间',\n                  type: 'bar',\n                  stack: 'total',\n                  label: {\n                    show: true\n                  },\n                  emphasis: {\n                    focus: 'series'\n                  },\n                  data: response.data.map(function (item) {\n                    return item.idleHours;\n                  })\n                }, {\n                  name: '维护时间',\n                  type: 'bar',\n                  stack: 'total',\n                  label: {\n                    show: true\n                  },\n                  emphasis: {\n                    focus: 'series'\n                  },\n                  data: response.data.map(function (item) {\n                    return item.maintenanceHours;\n                  })\n                }, {\n                  name: '故障时间',\n                  type: 'bar',\n                  stack: 'total',\n                  label: {\n                    show: true\n                  },\n                  emphasis: {\n                    focus: 'series'\n                  },\n                  data: response.data.map(function (item) {\n                    return item.errorHours;\n                  })\n                }]\n              };\n              _this6.charts.utilization.setOption(option);\n\n              // 取消图表的点击事件\n              _this6.charts.utilization.off('click');\n            case 7:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6);\n      }))();\n    },\n    // 机器人充电行为分析\n    renderRobotChart: function renderRobotChart(params) {\n      var _this7 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var response, option;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return energyEfficiencyApi.getRobotChargingBehavior(params);\n            case 2:\n              response = _context7.sent;\n              if (!_this7.charts.robot) {\n                _this7.charts.robot = echarts.init(_this7.$refs.robotChart);\n              }\n              option = {\n                title: {\n                  text: '机器人充电行为分析'\n                },\n                tooltip: {\n                  trigger: 'axis'\n                },\n                legend: {\n                  data: ['充电次数', '平均充电时长', '平均等待时间'],\n                  selectedMode: false\n                },\n                grid: {\n                  left: '3%',\n                  right: '4%',\n                  bottom: '3%',\n                  containLabel: true\n                },\n                xAxis: [{\n                  type: 'category',\n                  data: response.data.robots.map(function (robot) {\n                    return robot.name;\n                  }),\n                  axisPointer: {\n                    type: 'shadow'\n                  }\n                }],\n                yAxis: [{\n                  type: 'value',\n                  name: '次数',\n                  min: 0,\n                  axisLabel: {\n                    formatter: '{value}'\n                  }\n                }, {\n                  type: 'value',\n                  name: '时间 (分钟)',\n                  min: 0,\n                  axisLabel: {\n                    formatter: '{value} min'\n                  }\n                }],\n                series: [{\n                  name: '充电次数',\n                  type: 'bar',\n                  data: response.data.robots.map(function (robot) {\n                    return robot.chargingCount;\n                  })\n                }, {\n                  name: '平均充电时长',\n                  type: 'line',\n                  yAxisIndex: 1,\n                  data: response.data.robots.map(function (robot) {\n                    return robot.avgChargingDuration;\n                  })\n                }, {\n                  name: '平均等待时间',\n                  type: 'line',\n                  yAxisIndex: 1,\n                  data: response.data.robots.map(function (robot) {\n                    return robot.avgWaitingTime;\n                  })\n                }]\n              };\n              _this7.charts.robot.setOption(option);\n\n              // 取消图表的点击事件\n              _this7.charts.robot.off('click');\n            case 7:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7);\n      }))();\n    },\n    // 充电高峰期分析\n    renderPeakChart: function renderPeakChart(params) {\n      var _this8 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var response, option;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return energyEfficiencyApi.getChargingPeakAnalysis(params);\n            case 2:\n              response = _context8.sent;\n              if (!_this8.charts.peak) {\n                _this8.charts.peak = echarts.init(_this8.$refs.peakChart);\n              }\n              option = {\n                title: {\n                  text: '充电高峰期分析'\n                },\n                tooltip: {\n                  trigger: 'axis',\n                  axisPointer: {\n                    type: 'shadow'\n                  }\n                },\n                legend: {\n                  data: ['充电请求数', '平均等待时间'],\n                  selectedMode: false\n                },\n                grid: {\n                  left: '3%',\n                  right: '4%',\n                  bottom: '3%',\n                  containLabel: true\n                },\n                xAxis: [{\n                  type: 'category',\n                  data: ['0-2', '2-4', '4-6', '6-8', '8-10', '10-12', '12-14', '14-16', '16-18', '18-20', '20-22', '22-24'],\n                  axisLabel: {\n                    formatter: '{value}时'\n                  }\n                }],\n                yAxis: [{\n                  type: 'value',\n                  name: '请求数',\n                  min: 0,\n                  axisLabel: {\n                    formatter: '{value}'\n                  }\n                }, {\n                  type: 'value',\n                  name: '等待时间 (分钟)',\n                  min: 0,\n                  axisLabel: {\n                    formatter: '{value} min'\n                  }\n                }],\n                series: [{\n                  name: '充电请求数',\n                  type: 'bar',\n                  data: response.data.requestCounts\n                }, {\n                  name: '平均等待时间',\n                  type: 'line',\n                  yAxisIndex: 1,\n                  data: response.data.avgWaitingTimes\n                }]\n              };\n              _this8.charts.peak.setOption(option);\n\n              // 取消图表的点击事件\n              _this8.charts.peak.off('click');\n            case 7:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8);\n      }))();\n    },\n    // 获取筛选参数\n    getFilterParams: function getFilterParams() {\n      return {\n        startDate: this.dateRange[0] ? this.dateRange[0].toISOString() : null,\n        endDate: this.dateRange[1] ? this.dateRange[1].toISOString() : null,\n        stationIds: this.selectedStations.length > 0 ? this.selectedStations : null,\n        robotIds: this.selectedRobots.length > 0 ? this.selectedRobots : null\n      };\n    },\n    // 处理图表切换\n    handleChartChange: function handleChartChange(chartType) {\n      var titles = {\n        efficiency: '充电效率趋势分析',\n        consumption: '能耗分布热力图',\n        utilization: '充电站利用率对比',\n        robot: '机器人充电行为分析',\n        peak: '充电高峰期分析'\n      };\n      this.currentChartTitle = titles[chartType];\n      this.fetchChartData();\n    }\n  }\n};","map":{"version":3,"names":["echarts","energyEfficiencyApi","formatDateTime","calculateDuration","ArrowUp","ArrowDown","name","components","data","dateRange","Date","getTime","selectedStations","selectedRobots","stations","robots","currentChart","currentChartTitle","charts","efficiency","consumption","utilization","robot","peak","kpiData","title","value","unit","change","trend","mounted","initData","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stationsResponse","robotsResponse","wrap","_callee$","_context","prev","next","getStations","sent","getRobots","fetchKpiData","fetchChartData","t0","console","error","$message","stop","refreshData","_this2","_callee2","params","response","_callee2$","_context2","getFilterParams","getKpiData","avgEfficiency","toFixed","efficiencyChange","totalEnergy","energyChange","utilizationChange","avgWaitTime","waitTimeChange","successRate","successRateChange","totalOrders","ordersChange","_this3","_callee3","_callee3$","_context3","renderEfficiencyChart","abrupt","renderConsumptionChart","renderUtilizationChart","renderRobotChart","renderPeakChart","t1","_this4","_callee4","option","_callee4$","_context4","getEfficiencyTrend","init","$refs","efficiencyChart","text","left","top","tooltip","trigger","legend","map","station","selected","reduce","acc","type","orient","selectedMode","grid","right","bottom","containLabel","xAxis","boundaryGap","timeline","yAxis","min","max","series","efficiencyData","smooth","setOption","off","_this5","_callee5","hours","hourRanges","today","days","dayRanges","i","startDate","endDate","startFormatted","endFormatted","fixedMaxValue","dataMap","formattedData","_callee5$","_context5","log","getEnergyConsumptionDistribution","consumptionChart","length","height","h","start","parseInt","end","setDate","getDate","toISOString","split","push","forEach","item","Array","isArray","day","hour","parseFloat","isNaN","dayRange","dayIndex","hourRange","hourIndex","totalValue","count","startDay","endDay","d","currentDay","undefined","avgValue","slice","animation","position","formatter","hourStart","hourEnd","nextDay","concat","splitArea","show","axisLabel","parts","visualMap","calculable","realtime","inRange","color","itemWidth","itemHeight","precision","label","emphasis","itemStyle","shadowBlur","shadowColor","dispose","style","width","$nextTick","resize","chartError","stack","textStyle","_this6","_callee6","_callee6$","_context6","getStationUtilization","utilizationChart","axisPointer","stationName","focus","busyHours","idleHours","maintenanceHours","errorHours","_this7","_callee7","_callee7$","_context7","getRobotChargingBehavior","robotChart","chargingCount","yAxisIndex","avgChargingDuration","avgWaitingTime","_this8","_callee8","_callee8$","_context8","getChargingPeakAnalysis","peakChart","requestCounts","avgWaitingTimes","stationIds","robotIds","handleChartChange","chartType","titles"],"sources":["D:\\software_data\\Project\\Y0527\\CODE_BAK\\frontend\\src\\views\\EnergyEfficiency.vue"],"sourcesContent":["<template>\r\n  <div class=\"energy-efficiency-analysis\">\r\n    <!-- KPI指标卡片 -->\r\n    <el-row :gutter=\"20\" class=\"kpi-container\">\r\n      <el-col :span=\"4\" v-for=\"(kpi, index) in kpiData\" :key=\"index\">\r\n        <el-card class=\"kpi-card\">\r\n          <div class=\"kpi-title\">{{ kpi.title }}</div>\r\n          <div class=\"kpi-value\">{{ kpi.value }}{{ kpi.unit }}</div>\r\n          <div class=\"kpi-change\" :class=\"kpi.trend\">\r\n            <el-icon v-if=\"kpi.trend === 'up'\"><ArrowUp /></el-icon>\r\n            <el-icon v-else><ArrowDown /></el-icon>\r\n            {{ kpi.change }}%\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 分析图表区域 -->\r\n    <el-card class=\"chart-container\">\r\n      <div class=\"chart-header\">\r\n        <h3>{{ currentChartTitle }}</h3>\r\n        <el-radio-group v-model=\"currentChart\" @change=\"handleChartChange\">\r\n          <el-radio-button :value=\"'efficiency'\">充电效率趋势</el-radio-button>\r\n          <el-radio-button :value=\"'consumption'\">能耗分布</el-radio-button>\r\n          <el-radio-button :value=\"'utilization'\">充电站利用率</el-radio-button>\r\n          <el-radio-button :value=\"'robot'\">机器人充电分析</el-radio-button>\r\n          <el-radio-button :value=\"'peak'\">充电高峰期</el-radio-button>\r\n        </el-radio-group>\r\n      </div>\r\n      <div class=\"chart-content\">\r\n        <!-- 不同图表的容器 -->\r\n        <div v-show=\"currentChart === 'efficiency'\" class=\"chart-item\">\r\n          <div ref=\"efficiencyChart\" class=\"chart\"></div>\r\n        </div>\r\n        <div v-show=\"currentChart === 'consumption'\" class=\"chart-item\">\r\n          <div ref=\"consumptionChart\" class=\"chart\"></div>\r\n        </div>\r\n        <div v-show=\"currentChart === 'utilization'\" class=\"chart-item\">\r\n          <div ref=\"utilizationChart\" class=\"chart\"></div>\r\n        </div>\r\n        <div v-show=\"currentChart === 'robot'\" class=\"chart-item\">\r\n          <div ref=\"robotChart\" class=\"chart\"></div>\r\n        </div>\r\n        <div v-show=\"currentChart === 'peak'\" class=\"chart-item\">\r\n          <div ref=\"peakChart\" class=\"chart\"></div>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from 'echarts';\r\nimport energyEfficiencyApi from '@/api/energyEfficiency';\r\nimport { formatDateTime, calculateDuration } from '@/utils/dateTime';\r\nimport { ArrowUp, ArrowDown } from '@element-plus/icons-vue';\r\n\r\nexport default {\r\n  name: 'EnergyEfficiencyAnalysis',\r\n  components: {\r\n    ArrowUp,\r\n    ArrowDown\r\n  },\r\n  data() {\r\n    return {\r\n      // 固定的默认筛选条件（不再显示在UI上）\r\n      dateRange: [new Date(new Date().getTime() - 30 * 24 * 60 * 60 * 1000), new Date()],\r\n      selectedStations: [],\r\n      selectedRobots: [],\r\n      \r\n      // 数据列表\r\n      stations: [],\r\n      robots: [],\r\n      \r\n      // 图表相关\r\n      currentChart: 'efficiency',\r\n      currentChartTitle: '充电效率趋势分析',\r\n      charts: {\r\n        efficiency: null,\r\n        consumption: null,\r\n        utilization: null,\r\n        robot: null,\r\n        peak: null\r\n      },\r\n      \r\n      // KPI数据\r\n      kpiData: [\r\n        { title: '平均充电效率', value: 0, unit: '%', change: 0, trend: 'up' },\r\n        { title: '总能耗', value: 0, unit: 'kWh', change: 0, trend: 'up' },\r\n        { title: '充电器利用率', value: 0, unit: '%', change: 0, trend: 'up' },\r\n        { title: '平均等待时间', value: 0, unit: 'min', change: 0, trend: 'down' },\r\n        { title: '充电成功率', value: 0, unit: '%', change: 0, trend: 'up' },\r\n        { title: '总充电次数', value: 0, unit: '次', change: 0, trend: 'up' }\r\n      ]\r\n    };\r\n  },\r\n  \r\n  mounted() {\r\n    this.initData();\r\n  },\r\n  \r\n  methods: {\r\n    async initData() {\r\n      try {\r\n        // 获取充电站列表\r\n        const stationsResponse = await energyEfficiencyApi.getStations();\r\n        this.stations = stationsResponse.data;\r\n        \r\n        // 获取机器人列表\r\n        const robotsResponse = await energyEfficiencyApi.getRobots();\r\n        this.robots = robotsResponse.data;\r\n        \r\n        // 获取初始数据\r\n        this.fetchKpiData();\r\n        this.fetchChartData();\r\n      } catch (error) {\r\n        console.error('初始化数据失败:', error);\r\n        this.$message.error('加载数据失败，请重试');\r\n      }\r\n    },\r\n    \r\n    // 刷新所有数据\r\n    refreshData() {\r\n      this.fetchKpiData();\r\n      this.fetchChartData();\r\n    },\r\n    \r\n    // 获取KPI数据\r\n    async fetchKpiData() {\r\n      try {\r\n        const params = this.getFilterParams();\r\n        const response = await energyEfficiencyApi.getKpiData(params);\r\n        \r\n        this.kpiData = [\r\n          { \r\n            title: '平均充电效率', \r\n            value: response.data.avgEfficiency.toFixed(2), \r\n            unit: '%', \r\n            change: response.data.efficiencyChange.toFixed(2), \r\n            trend: response.data.efficiencyChange >= 0 ? 'up' : 'down' \r\n          },\r\n          { \r\n            title: '总能耗', \r\n            value: response.data.totalEnergy.toFixed(2), \r\n            unit: 'kWh', \r\n            change: response.data.energyChange.toFixed(2), \r\n            trend: response.data.energyChange >= 0 ? 'up' : 'down' \r\n          },\r\n          { \r\n            title: '充电器利用率', \r\n            value: response.data.utilization.toFixed(2), \r\n            unit: '%', \r\n            change: response.data.utilizationChange.toFixed(2), \r\n            trend: response.data.utilizationChange >= 0 ? 'up' : 'down' \r\n          },\r\n          { \r\n            title: '平均等待时间', \r\n            value: response.data.avgWaitTime.toFixed(2), \r\n            unit: 'min', \r\n            change: response.data.waitTimeChange.toFixed(2), \r\n            trend: response.data.waitTimeChange >= 0 ? 'up' : 'down' \r\n          },\r\n          { \r\n            title: '充电成功率', \r\n            value: response.data.successRate.toFixed(2), \r\n            unit: '%', \r\n            change: response.data.successRateChange.toFixed(2), \r\n            trend: response.data.successRateChange >= 0 ? 'up' : 'down' \r\n          },\r\n          { \r\n            title: '总充电次数', \r\n            value: response.data.totalOrders || 0, \r\n            unit: '次', \r\n            change: response.data.ordersChange || 0, \r\n            trend: (response.data.ordersChange || 0) >= 0 ? 'up' : 'down' \r\n          }\r\n        ];\r\n      } catch (error) {\r\n        console.error('获取KPI数据失败:', error);\r\n        this.$message.error('获取KPI数据失败');\r\n      }\r\n    },\r\n    \r\n    // 获取图表数据并渲染\r\n    async fetchChartData() {\r\n      try {\r\n        const params = this.getFilterParams();\r\n        \r\n        // 根据当前选择的图表类型获取数据\r\n        switch (this.currentChart) {\r\n          case 'efficiency':\r\n            await this.renderEfficiencyChart(params);\r\n            break;\r\n          case 'consumption':\r\n            await this.renderConsumptionChart(params);\r\n            break;\r\n          case 'utilization':\r\n            await this.renderUtilizationChart(params);\r\n            break;\r\n          case 'robot':\r\n            await this.renderRobotChart(params);\r\n            break;\r\n          case 'peak':\r\n            await this.renderPeakChart(params);\r\n            break;\r\n        }\r\n      } catch (error) {\r\n        console.error('获取图表数据失败:', error);\r\n        this.$message.error('获取图表数据失败');\r\n      }\r\n    },\r\n    \r\n    // 充电效率趋势图\r\n    async renderEfficiencyChart(params) {\r\n      const response = await energyEfficiencyApi.getEfficiencyTrend(params);\r\n      \r\n      if (!this.charts.efficiency) {\r\n        this.charts.efficiency = echarts.init(this.$refs.efficiencyChart);\r\n      }\r\n      \r\n      const option = {\r\n        title: {\r\n          text: '充电效率趋势分析',\r\n          left: 'center',\r\n          top: '10px'\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis'\r\n        },\r\n        legend: {\r\n          data: response.data.stations.map(station => station.name),\r\n          selected: response.data.stations.reduce((acc, station) => {\r\n            acc[station.name] = true;\r\n            return acc;\r\n          }, {}),\r\n          top: '40px',\r\n          type: 'scroll',\r\n          orient: 'horizontal',\r\n          selectedMode: false\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          top: '100px',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          boundaryGap: false,\r\n          data: response.data.timeline\r\n        },\r\n        yAxis: {\r\n          type: 'value',\r\n          name: '充电效率 (%)',\r\n          min: 50,\r\n          max: 100\r\n        },\r\n        series: response.data.stations.map(station => ({\r\n          name: station.name,\r\n          type: 'line',\r\n          data: station.efficiencyData,\r\n          smooth: true\r\n        }))\r\n      };\r\n      \r\n      this.charts.efficiency.setOption(option);\r\n      \r\n      // 取消图表的点击事件\r\n      this.charts.efficiency.off('click');\r\n    },\r\n    \r\n    // 能耗分布热力图\r\n    async renderConsumptionChart(params) {\r\n      try {\r\n        console.log('获取能耗分布数据，参数:', params);\r\n        const response = await energyEfficiencyApi.getEnergyConsumptionDistribution(params);\r\n        console.log('能耗分布数据响应:', response.data);\r\n        \r\n        if (!this.charts.consumption) {\r\n          this.charts.consumption = echarts.init(this.$refs.consumptionChart);\r\n        }\r\n        \r\n        // 检查返回的数据\r\n        if (!response.data || !response.data.days || !response.data.data || response.data.days.length === 0) {\r\n          console.error('能耗分布数据异常:', response.data);\r\n          // 显示一个空的图表\r\n          this.charts.consumption.setOption({\r\n            title: {\r\n              text: '能耗分布热力图 (无数据)',\r\n              left: 'center',\r\n              top: '10px'\r\n            },\r\n            grid: {\r\n              height: '70%',\r\n              top: '10%'\r\n            }\r\n          });\r\n          return;\r\n        }\r\n        \r\n        // 定义X轴为每2小时一个刻度，从0到22\r\n        const hours = ['0', '2', '4', '6', '8', '10', '12', '14', '16', '18', '20', '22'];\r\n        const hourRanges = hours.map(h => {\r\n          const start = parseInt(h);\r\n          const end = start + 1;\r\n          return { start, end };\r\n        });\r\n        \r\n        // 计算30天日期范围，每2天一个刻度\r\n        const today = new Date();\r\n        const days = [];\r\n        const dayRanges = [];\r\n        \r\n        for (let i = 29; i >= 0; i -= 2) {\r\n          // 当前2天区间的开始日期\r\n          const startDate = new Date(today);\r\n          startDate.setDate(today.getDate() - i);\r\n          \r\n          // 当前2天区间的结束日期\r\n          const endDate = new Date(startDate);\r\n          endDate.setDate(startDate.getDate() + 1);\r\n          \r\n          // 格式化日期为与API相同的格式 \"YYYY-MM-DD\"\r\n          const startFormatted = startDate.toISOString().split('T')[0];\r\n          const endFormatted = endDate.toISOString().split('T')[0];\r\n          \r\n          // 使用开始日期作为标签\r\n          days.push(startFormatted);\r\n          \r\n          // 保存日期范围用于数据聚合\r\n          dayRanges.push({\r\n            start: startFormatted,\r\n            end: endFormatted\r\n          });\r\n        }\r\n        \r\n        console.log('X轴时间段数:', hours.length, 'Y轴日期段数:', days.length, '总格子数:', hours.length * days.length);\r\n        \r\n        // 使用固定的最大值\r\n        const fixedMaxValue = 120;\r\n        \r\n        // 将API返回的数据转换为映射表，便于快速查找\r\n        const dataMap = {};\r\n        response.data.data.forEach(item => {\r\n          if (Array.isArray(item) && item.length === 3) {\r\n            const day = item[0];\r\n            const hour = parseInt(item[1]);\r\n            const value = parseFloat(item[2] || 0);\r\n            \r\n            if (!isNaN(value) && hour >= 0 && hour < 24) {\r\n              if (!dataMap[day]) {\r\n                dataMap[day] = {};\r\n              }\r\n              dataMap[day][hour] = value;\r\n            }\r\n          }\r\n        });\r\n        \r\n        // 生成180个格子数据 (12个时间段 * 15个日期段)\r\n        const formattedData = [];\r\n        \r\n        dayRanges.forEach((dayRange, dayIndex) => {\r\n          hourRanges.forEach((hourRange, hourIndex) => {\r\n            // 计算该格子的平均能耗值\r\n            let totalValue = 0;\r\n            let count = 0;\r\n            \r\n            // 遍历当前日期范围内的所有日期\r\n            const startDay = new Date(dayRange.start);\r\n            const endDay = new Date(dayRange.end);\r\n            \r\n            for (let d = new Date(startDay); d <= endDay; d.setDate(d.getDate() + 1)) {\r\n              const currentDay = d.toISOString().split('T')[0];\r\n              \r\n              // 遍历当前时间范围内的所有小时\r\n              for (let h = hourRange.start; h <= hourRange.end; h++) {\r\n                if (dataMap[currentDay] && dataMap[currentDay][h] !== undefined) {\r\n                  totalValue += dataMap[currentDay][h];\r\n                  count++;\r\n                }\r\n              }\r\n            }\r\n            \r\n            // 计算平均值，如果没有数据则为0\r\n            const avgValue = count > 0 ? totalValue / count : 0;\r\n            \r\n            // 添加到格式化数据中 [x索引, y索引, 值]\r\n            formattedData.push([hourIndex, dayIndex, avgValue]);\r\n          });\r\n        });\r\n        \r\n        console.log('格式化后的数据点数:', formattedData.length);\r\n        console.log('格式化后的数据示例:', formattedData.slice(0, 3));\r\n        \r\n        // 添加详细调试日志\r\n        console.log('热力图数据详情:');\r\n        console.log('- X轴类别数据:', hours);\r\n        console.log('- Y轴类别数据长度:', days.length);\r\n        console.log('- 第一个数据点:', formattedData[0]);\r\n        if (formattedData[0]) {\r\n          console.log('  - X索引:', formattedData[0][0], '对应值:', hours[formattedData[0][0]]);\r\n          console.log('  - Y索引:', formattedData[0][1], '对应值:', days[formattedData[0][1]]);\r\n          console.log('  - 数值:', formattedData[0][2]);\r\n        }\r\n        \r\n        const option = {\r\n          animation: false,  // 禁用动画，避免渲染问题\r\n          title: {\r\n            text: '能耗分布热力图',\r\n            left: 'center',\r\n            top: '10px'\r\n          },\r\n          tooltip: {\r\n            position: 'top',\r\n            formatter: function (params) {\r\n              const hourIndex = params.data[0];\r\n              const hourStart = hours[hourIndex];\r\n              const hourEnd = parseInt(hourStart) + 2;\r\n              const dayIndex = params.data[1];\r\n              const day = days[dayIndex];\r\n              const nextDay = dayRanges[dayIndex].end;\r\n              const value = params.data[2];\r\n              return `时间段: ${hourStart}:00-${hourEnd}:00<br>日期: ${day} 至 ${nextDay}<br>能耗: ${value.toFixed(2)} kWh`;\r\n            }\r\n          },\r\n          grid: {\r\n            height: '70%',\r\n            top: '60px',\r\n            left: '80px',\r\n            right: '30px'\r\n          },\r\n          xAxis: {\r\n            type: 'category',\r\n            data: hours,\r\n            splitArea: {\r\n              show: true\r\n            },\r\n            axisLabel: {\r\n              formatter: '{value}:00'\r\n            }\r\n          },\r\n          yAxis: {\r\n            type: 'category',\r\n            data: days,\r\n            splitArea: {\r\n              show: true\r\n            },\r\n            axisLabel: {\r\n              formatter: function (value) {\r\n                // 只显示月和日\r\n                const parts = value.split('-');\r\n                return parts[1] + '-' + parts[2];\r\n              }\r\n            }\r\n          },\r\n          visualMap: {\r\n            type: 'continuous',\r\n            min: 0,\r\n            max: fixedMaxValue,\r\n            calculable: false, // 禁用拖动调节\r\n            realtime: false,   // 禁用实时更新\r\n            orient: 'horizontal',\r\n            left: 'center',\r\n            bottom: '5%',\r\n            inRange: {\r\n              color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']\r\n            },\r\n            text: ['高', '低'],     // 两端的文本\r\n            itemWidth: 15,         // 图形的宽度\r\n            itemHeight: 120,       // 图形的高度\r\n            precision: 0           // 数据展示的小数精度\r\n          },\r\n          series: [{\r\n            name: '能耗 (kWh)',\r\n            type: 'heatmap',\r\n            data: formattedData,\r\n            label: {\r\n              show: false\r\n            },\r\n            emphasis: {\r\n              itemStyle: {\r\n                shadowBlur: 10,\r\n                shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n              }\r\n            }\r\n          }]\r\n        };\r\n        \r\n        // 尝试设置图表选项\r\n        try {\r\n          // 完全销毁并重新创建图表实例\r\n          if (this.charts.consumption) {\r\n            this.charts.consumption.dispose();\r\n          }\r\n          \r\n          // 确保DOM元素存在且有尺寸\r\n          if (this.$refs.consumptionChart) {\r\n            // 设置明确的宽高\r\n            this.$refs.consumptionChart.style.width = '100%';\r\n            this.$refs.consumptionChart.style.height = '500px';  // 增加高度以容纳更多数据\r\n            \r\n            // 初始化图表\r\n            this.charts.consumption = echarts.init(this.$refs.consumptionChart);\r\n            \r\n            // 强制应用选项\r\n            this.charts.consumption.setOption(option, true);\r\n            console.log('热力图渲染成功');\r\n            \r\n            // 强制重绘\r\n            this.$nextTick(() => {\r\n              if (this.charts.consumption) {\r\n                this.charts.consumption.resize();\r\n              }\r\n            });\r\n            \r\n            // 取消图表的点击事件\r\n            this.charts.consumption.off('click');\r\n          } else {\r\n            console.error('热力图DOM元素不存在');\r\n          }\r\n        } catch (chartError) {\r\n          console.error('设置热力图选项失败:', chartError);\r\n          console.error('错误详情:', chartError.stack);\r\n          // 尝试重新创建图表实例\r\n          if (this.$refs.consumptionChart) {\r\n            if (this.charts.consumption) {\r\n              this.charts.consumption.dispose();\r\n            }\r\n            this.charts.consumption = echarts.init(this.$refs.consumptionChart);\r\n            this.charts.consumption.setOption({\r\n              title: {\r\n                text: '能耗分布热力图 (渲染失败)',\r\n                textStyle: {\r\n                  color: '#ff0000'\r\n                },\r\n                left: 'center',\r\n                top: '10px'\r\n              }\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('渲染能耗分布热力图失败:', error);\r\n        console.error('错误详情:', error.stack);\r\n        // 显示错误信息\r\n        if (this.charts.consumption) {\r\n          this.charts.consumption.setOption({\r\n            title: {\r\n              text: '能耗分布热力图 (加载失败)',\r\n              textStyle: {\r\n                color: '#ff0000'\r\n              },\r\n              left: 'center',\r\n              top: '10px'\r\n            }\r\n          });\r\n        }\r\n      }\r\n    },\r\n    \r\n    // 充电站利用率对比\r\n    async renderUtilizationChart(params) {\r\n      const response = await energyEfficiencyApi.getStationUtilization(params);\r\n      \r\n      if (!this.charts.utilization) {\r\n        this.charts.utilization = echarts.init(this.$refs.utilizationChart);\r\n      }\r\n      \r\n      const option = {\r\n        title: {\r\n          text: '充电站利用率对比'\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'shadow'\r\n          }\r\n        },\r\n        legend: {\r\n          data: ['忙碌时间', '空闲时间', '维护时间', '故障时间'],\r\n          selectedMode: false\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'value',\r\n          name: '小时',\r\n          max: 24\r\n        },\r\n        yAxis: {\r\n          type: 'category',\r\n          data: response.data.map(item => item.stationName)\r\n        },\r\n        series: [\r\n          {\r\n            name: '忙碌时间',\r\n            type: 'bar',\r\n            stack: 'total',\r\n            label: {\r\n              show: true\r\n            },\r\n            emphasis: {\r\n              focus: 'series'\r\n            },\r\n            data: response.data.map(item => item.busyHours)\r\n          },\r\n          {\r\n            name: '空闲时间',\r\n            type: 'bar',\r\n            stack: 'total',\r\n            label: {\r\n              show: true\r\n            },\r\n            emphasis: {\r\n              focus: 'series'\r\n            },\r\n            data: response.data.map(item => item.idleHours)\r\n          },\r\n          {\r\n            name: '维护时间',\r\n            type: 'bar',\r\n            stack: 'total',\r\n            label: {\r\n              show: true\r\n            },\r\n            emphasis: {\r\n              focus: 'series'\r\n            },\r\n            data: response.data.map(item => item.maintenanceHours)\r\n          },\r\n          {\r\n            name: '故障时间',\r\n            type: 'bar',\r\n            stack: 'total',\r\n            label: {\r\n              show: true\r\n            },\r\n            emphasis: {\r\n              focus: 'series'\r\n            },\r\n            data: response.data.map(item => item.errorHours)\r\n          }\r\n        ]\r\n      };\r\n      \r\n      this.charts.utilization.setOption(option);\r\n      \r\n      // 取消图表的点击事件\r\n      this.charts.utilization.off('click');\r\n    },\r\n    \r\n    // 机器人充电行为分析\r\n    async renderRobotChart(params) {\r\n      const response = await energyEfficiencyApi.getRobotChargingBehavior(params);\r\n      \r\n      if (!this.charts.robot) {\r\n        this.charts.robot = echarts.init(this.$refs.robotChart);\r\n      }\r\n      \r\n      const option = {\r\n        title: {\r\n          text: '机器人充电行为分析'\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis'\r\n        },\r\n        legend: {\r\n          data: ['充电次数', '平均充电时长', '平均等待时间'],\r\n          selectedMode: false\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: [\r\n          {\r\n            type: 'category',\r\n            data: response.data.robots.map(robot => robot.name),\r\n            axisPointer: {\r\n              type: 'shadow'\r\n            }\r\n          }\r\n        ],\r\n        yAxis: [\r\n          {\r\n            type: 'value',\r\n            name: '次数',\r\n            min: 0,\r\n            axisLabel: {\r\n              formatter: '{value}'\r\n            }\r\n          },\r\n          {\r\n            type: 'value',\r\n            name: '时间 (分钟)',\r\n            min: 0,\r\n            axisLabel: {\r\n              formatter: '{value} min'\r\n            }\r\n          }\r\n        ],\r\n        series: [\r\n          {\r\n            name: '充电次数',\r\n            type: 'bar',\r\n            data: response.data.robots.map(robot => robot.chargingCount)\r\n          },\r\n          {\r\n            name: '平均充电时长',\r\n            type: 'line',\r\n            yAxisIndex: 1,\r\n            data: response.data.robots.map(robot => robot.avgChargingDuration)\r\n          },\r\n          {\r\n            name: '平均等待时间',\r\n            type: 'line',\r\n            yAxisIndex: 1,\r\n            data: response.data.robots.map(robot => robot.avgWaitingTime)\r\n          }\r\n        ]\r\n      };\r\n      \r\n      this.charts.robot.setOption(option);\r\n      \r\n      // 取消图表的点击事件\r\n      this.charts.robot.off('click');\r\n    },\r\n    \r\n    // 充电高峰期分析\r\n    async renderPeakChart(params) {\r\n      const response = await energyEfficiencyApi.getChargingPeakAnalysis(params);\r\n      \r\n      if (!this.charts.peak) {\r\n        this.charts.peak = echarts.init(this.$refs.peakChart);\r\n      }\r\n      \r\n      const option = {\r\n        title: {\r\n          text: '充电高峰期分析'\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'shadow'\r\n          }\r\n        },\r\n        legend: {\r\n          data: ['充电请求数', '平均等待时间'],\r\n          selectedMode: false\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: [\r\n          {\r\n            type: 'category',\r\n            data: ['0-2', '2-4', '4-6', '6-8', '8-10', '10-12', '12-14', '14-16', '16-18', '18-20', '20-22', '22-24'],\r\n            axisLabel: {\r\n              formatter: '{value}时'\r\n            }\r\n          }\r\n        ],\r\n        yAxis: [\r\n          {\r\n            type: 'value',\r\n            name: '请求数',\r\n            min: 0,\r\n            axisLabel: {\r\n              formatter: '{value}'\r\n            }\r\n          },\r\n          {\r\n            type: 'value',\r\n            name: '等待时间 (分钟)',\r\n            min: 0,\r\n            axisLabel: {\r\n              formatter: '{value} min'\r\n            }\r\n          }\r\n        ],\r\n        series: [\r\n          {\r\n            name: '充电请求数',\r\n            type: 'bar',\r\n            data: response.data.requestCounts\r\n          },\r\n          {\r\n            name: '平均等待时间',\r\n            type: 'line',\r\n            yAxisIndex: 1,\r\n            data: response.data.avgWaitingTimes\r\n          }\r\n        ]\r\n      };\r\n      \r\n      this.charts.peak.setOption(option);\r\n      \r\n      // 取消图表的点击事件\r\n      this.charts.peak.off('click');\r\n    },\r\n    \r\n    // 获取筛选参数\r\n    getFilterParams() {\r\n      return {\r\n        startDate: this.dateRange[0] ? this.dateRange[0].toISOString() : null,\r\n        endDate: this.dateRange[1] ? this.dateRange[1].toISOString() : null,\r\n        stationIds: this.selectedStations.length > 0 ? this.selectedStations : null,\r\n        robotIds: this.selectedRobots.length > 0 ? this.selectedRobots : null\r\n      };\r\n    },\r\n    \r\n    // 处理图表切换\r\n    handleChartChange(chartType) {\r\n      const titles = {\r\n        efficiency: '充电效率趋势分析',\r\n        consumption: '能耗分布热力图',\r\n        utilization: '充电站利用率对比',\r\n        robot: '机器人充电行为分析',\r\n        peak: '充电高峰期分析'\r\n      };\r\n      \r\n      this.currentChartTitle = titles[chartType];\r\n      this.fetchChartData();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.energy-efficiency-analysis {\r\n  padding: 20px;\r\n}\r\n\r\n.kpi-container {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.kpi-card {\r\n  text-align: center;\r\n  padding: 10px;\r\n}\r\n\r\n.kpi-title {\r\n  font-size: 14px;\r\n  color: #666;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.kpi-value {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.kpi-change {\r\n  font-size: 12px;\r\n}\r\n\r\n.kpi-change.up {\r\n  color: #67c23a;\r\n}\r\n\r\n.kpi-change.down {\r\n  color: #f56c6c;\r\n}\r\n\r\n.chart-container {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.chart-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.chart-content {\r\n  position: relative;\r\n}\r\n\r\n.chart-item {\r\n  position: relative;\r\n}\r\n\r\n.chart {\r\n  height: 400px;\r\n  width: 100%;\r\n}\r\n</style> "],"mappings":";;;;;;;;;;;;;;;;;;;;;AAoDA,OAAO,KAAKA,OAAM,MAAO,SAAS;AAClC,OAAOC,mBAAkB,MAAO,wBAAwB;AACxD,SAASC,cAAc,EAAEC,iBAAgB,QAAS,kBAAkB;AACpE,SAASC,OAAO,EAAEC,SAAQ,QAAS,yBAAyB;AAE5D,eAAe;EACbC,IAAI,EAAE,0BAA0B;EAChCC,UAAU,EAAE;IACVH,OAAO,EAAPA,OAAO;IACPC,SAAQ,EAARA;EACF,CAAC;EACDG,IAAI,WAAJA,IAAIA,CAAA,EAAG;IACL,OAAO;MACL;MACAC,SAAS,EAAE,CAAC,IAAIC,IAAI,CAAC,IAAIA,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,IAAI,EAAC,GAAI,EAAC,GAAI,EAAC,GAAI,EAAC,GAAI,IAAI,CAAC,EAAE,IAAID,IAAI,CAAC,CAAC,CAAC;MAClFE,gBAAgB,EAAE,EAAE;MACpBC,cAAc,EAAE,EAAE;MAElB;MACAC,QAAQ,EAAE,EAAE;MACZC,MAAM,EAAE,EAAE;MAEV;MACAC,YAAY,EAAE,YAAY;MAC1BC,iBAAiB,EAAE,UAAU;MAC7BC,MAAM,EAAE;QACNC,UAAU,EAAE,IAAI;QAChBC,WAAW,EAAE,IAAI;QACjBC,WAAW,EAAE,IAAI;QACjBC,KAAK,EAAE,IAAI;QACXC,IAAI,EAAE;MACR,CAAC;MAED;MACAC,OAAO,EAAE,CACP;QAAEC,KAAK,EAAE,QAAQ;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAK,CAAC,EAChE;QAAEJ,KAAK,EAAE,KAAK;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE,KAAK;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAK,CAAC,EAC/D;QAAEJ,KAAK,EAAE,QAAQ;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAK,CAAC,EAChE;QAAEJ,KAAK,EAAE,QAAQ;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE,KAAK;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAO,CAAC,EACpE;QAAEJ,KAAK,EAAE,OAAO;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAK,CAAC,EAC/D;QAAEJ,KAAK,EAAE,OAAO;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAK;IAElE,CAAC;EACH,CAAC;EAEDC,OAAO,WAAPA,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,QAAQ,CAAC,CAAC;EACjB,CAAC;EAEDC,OAAO,EAAE;IACDD,QAAQ,WAARA,QAAQA,CAAA,EAAG;MAAA,IAAAE,KAAA;MAAA,OAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,gBAAA,EAAAC,cAAA;QAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAGkB3C,mBAAmB,CAAC4C,WAAW,CAAC,CAAC;YAAA;cAA1DP,gBAAe,GAAAI,QAAA,CAAAI,IAAA;cACrBb,KAAI,CAACnB,QAAO,GAAIwB,gBAAgB,CAAC9B,IAAI;;cAErC;cAAAkC,QAAA,CAAAE,IAAA;cAAA,OAC6B3C,mBAAmB,CAAC8C,SAAS,CAAC,CAAC;YAAA;cAAtDR,cAAa,GAAAG,QAAA,CAAAI,IAAA;cACnBb,KAAI,CAAClB,MAAK,GAAIwB,cAAc,CAAC/B,IAAI;;cAEjC;cACAyB,KAAI,CAACe,YAAY,CAAC,CAAC;cACnBf,KAAI,CAACgB,cAAc,CAAC,CAAC;cAAAP,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAQ,EAAA,GAAAR,QAAA;cAErBS,OAAO,CAACC,KAAK,CAAC,UAAU,EAAAV,QAAA,CAAAQ,EAAO,CAAC;cAChCjB,KAAI,CAACoB,QAAQ,CAACD,KAAK,CAAC,YAAY,CAAC;YAAA;YAAA;cAAA,OAAAV,QAAA,CAAAY,IAAA;UAAA;QAAA,GAAAjB,OAAA;MAAA;IAErC,CAAC;IAED;IACAkB,WAAW,WAAXA,WAAWA,CAAA,EAAG;MACZ,IAAI,CAACP,YAAY,CAAC,CAAC;MACnB,IAAI,CAACC,cAAc,CAAC,CAAC;IACvB,CAAC;IAED;IACMD,YAAY,WAAZA,YAAYA,CAAA,EAAG;MAAA,IAAAQ,MAAA;MAAA,OAAAtB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAqB,SAAA;QAAA,IAAAC,MAAA,EAAAC,QAAA;QAAA,OAAAxB,mBAAA,GAAAK,IAAA,UAAAoB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAlB,IAAA,GAAAkB,SAAA,CAAAjB,IAAA;YAAA;cAAAiB,SAAA,CAAAlB,IAAA;cAEXe,MAAK,GAAIF,MAAI,CAACM,eAAe,CAAC,CAAC;cAAAD,SAAA,CAAAjB,IAAA;cAAA,OACd3C,mBAAmB,CAAC8D,UAAU,CAACL,MAAM,CAAC;YAAA;cAAvDC,QAAO,GAAAE,SAAA,CAAAf,IAAA;cAEbU,MAAI,CAAChC,OAAM,GAAI,CACb;gBACEC,KAAK,EAAE,QAAQ;gBACfC,KAAK,EAAEiC,QAAQ,CAACnD,IAAI,CAACwD,aAAa,CAACC,OAAO,CAAC,CAAC,CAAC;gBAC7CtC,IAAI,EAAE,GAAG;gBACTC,MAAM,EAAE+B,QAAQ,CAACnD,IAAI,CAAC0D,gBAAgB,CAACD,OAAO,CAAC,CAAC,CAAC;gBACjDpC,KAAK,EAAE8B,QAAQ,CAACnD,IAAI,CAAC0D,gBAAe,IAAK,IAAI,IAAG,GAAI;cACtD,CAAC,EACD;gBACEzC,KAAK,EAAE,KAAK;gBACZC,KAAK,EAAEiC,QAAQ,CAACnD,IAAI,CAAC2D,WAAW,CAACF,OAAO,CAAC,CAAC,CAAC;gBAC3CtC,IAAI,EAAE,KAAK;gBACXC,MAAM,EAAE+B,QAAQ,CAACnD,IAAI,CAAC4D,YAAY,CAACH,OAAO,CAAC,CAAC,CAAC;gBAC7CpC,KAAK,EAAE8B,QAAQ,CAACnD,IAAI,CAAC4D,YAAW,IAAK,IAAI,IAAG,GAAI;cAClD,CAAC,EACD;gBACE3C,KAAK,EAAE,QAAQ;gBACfC,KAAK,EAAEiC,QAAQ,CAACnD,IAAI,CAACa,WAAW,CAAC4C,OAAO,CAAC,CAAC,CAAC;gBAC3CtC,IAAI,EAAE,GAAG;gBACTC,MAAM,EAAE+B,QAAQ,CAACnD,IAAI,CAAC6D,iBAAiB,CAACJ,OAAO,CAAC,CAAC,CAAC;gBAClDpC,KAAK,EAAE8B,QAAQ,CAACnD,IAAI,CAAC6D,iBAAgB,IAAK,IAAI,IAAG,GAAI;cACvD,CAAC,EACD;gBACE5C,KAAK,EAAE,QAAQ;gBACfC,KAAK,EAAEiC,QAAQ,CAACnD,IAAI,CAAC8D,WAAW,CAACL,OAAO,CAAC,CAAC,CAAC;gBAC3CtC,IAAI,EAAE,KAAK;gBACXC,MAAM,EAAE+B,QAAQ,CAACnD,IAAI,CAAC+D,cAAc,CAACN,OAAO,CAAC,CAAC,CAAC;gBAC/CpC,KAAK,EAAE8B,QAAQ,CAACnD,IAAI,CAAC+D,cAAa,IAAK,IAAI,IAAG,GAAI;cACpD,CAAC,EACD;gBACE9C,KAAK,EAAE,OAAO;gBACdC,KAAK,EAAEiC,QAAQ,CAACnD,IAAI,CAACgE,WAAW,CAACP,OAAO,CAAC,CAAC,CAAC;gBAC3CtC,IAAI,EAAE,GAAG;gBACTC,MAAM,EAAE+B,QAAQ,CAACnD,IAAI,CAACiE,iBAAiB,CAACR,OAAO,CAAC,CAAC,CAAC;gBAClDpC,KAAK,EAAE8B,QAAQ,CAACnD,IAAI,CAACiE,iBAAgB,IAAK,IAAI,IAAG,GAAI;cACvD,CAAC,EACD;gBACEhD,KAAK,EAAE,OAAO;gBACdC,KAAK,EAAEiC,QAAQ,CAACnD,IAAI,CAACkE,WAAU,IAAK,CAAC;gBACrC/C,IAAI,EAAE,GAAG;gBACTC,MAAM,EAAE+B,QAAQ,CAACnD,IAAI,CAACmE,YAAW,IAAK,CAAC;gBACvC9C,KAAK,EAAE,CAAC8B,QAAQ,CAACnD,IAAI,CAACmE,YAAW,IAAK,CAAC,KAAK,IAAI,IAAG,GAAI;cACzD,EACD;cAAAd,SAAA,CAAAjB,IAAA;cAAA;YAAA;cAAAiB,SAAA,CAAAlB,IAAA;cAAAkB,SAAA,CAAAX,EAAA,GAAAW,SAAA;cAEDV,OAAO,CAACC,KAAK,CAAC,YAAY,EAAAS,SAAA,CAAAX,EAAO,CAAC;cAClCM,MAAI,CAACH,QAAQ,CAACD,KAAK,CAAC,WAAW,CAAC;YAAA;YAAA;cAAA,OAAAS,SAAA,CAAAP,IAAA;UAAA;QAAA,GAAAG,QAAA;MAAA;IAEpC,CAAC;IAED;IACMR,cAAc,WAAdA,cAAcA,CAAA,EAAG;MAAA,IAAA2B,MAAA;MAAA,OAAA1C,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAyC,SAAA;QAAA,IAAAnB,MAAA;QAAA,OAAAvB,mBAAA,GAAAK,IAAA,UAAAsC,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAApC,IAAA,GAAAoC,SAAA,CAAAnC,IAAA;YAAA;cAAAmC,SAAA,CAAApC,IAAA;cAEbe,MAAK,GAAIkB,MAAI,CAACd,eAAe,CAAC,CAAC,EAErC;cAAAiB,SAAA,CAAA7B,EAAA,GACQ0B,MAAI,CAAC5D,YAAY;cAAA+D,SAAA,CAAAnC,IAAA,GAAAmC,SAAA,CAAA7B,EAAA,KAClB,YAAY,OAAA6B,SAAA,CAAA7B,EAAA,KAGZ,aAAa,OAAA6B,SAAA,CAAA7B,EAAA,KAGb,aAAa,QAAA6B,SAAA,CAAA7B,EAAA,KAGb,OAAO,QAAA6B,SAAA,CAAA7B,EAAA,KAGP,MAAM;cAAA;YAAA;cAAA6B,SAAA,CAAAnC,IAAA;cAAA,OAXHgC,MAAI,CAACI,qBAAqB,CAACtB,MAAM,CAAC;YAAA;cAAA,OAAAqB,SAAA,CAAAE,MAAA;YAAA;cAAAF,SAAA,CAAAnC,IAAA;cAAA,OAGlCgC,MAAI,CAACM,sBAAsB,CAACxB,MAAM,CAAC;YAAA;cAAA,OAAAqB,SAAA,CAAAE,MAAA;YAAA;cAAAF,SAAA,CAAAnC,IAAA;cAAA,OAGnCgC,MAAI,CAACO,sBAAsB,CAACzB,MAAM,CAAC;YAAA;cAAA,OAAAqB,SAAA,CAAAE,MAAA;YAAA;cAAAF,SAAA,CAAAnC,IAAA;cAAA,OAGnCgC,MAAI,CAACQ,gBAAgB,CAAC1B,MAAM,CAAC;YAAA;cAAA,OAAAqB,SAAA,CAAAE,MAAA;YAAA;cAAAF,SAAA,CAAAnC,IAAA;cAAA,OAG7BgC,MAAI,CAACS,eAAe,CAAC3B,MAAM,CAAC;YAAA;cAAA,OAAAqB,SAAA,CAAAE,MAAA;YAAA;cAAAF,SAAA,CAAAnC,IAAA;cAAA;YAAA;cAAAmC,SAAA,CAAApC,IAAA;cAAAoC,SAAA,CAAAO,EAAA,GAAAP,SAAA;cAItC5B,OAAO,CAACC,KAAK,CAAC,WAAW,EAAA2B,SAAA,CAAAO,EAAO,CAAC;cACjCV,MAAI,CAACvB,QAAQ,CAACD,KAAK,CAAC,UAAU,CAAC;YAAA;YAAA;cAAA,OAAA2B,SAAA,CAAAzB,IAAA;UAAA;QAAA,GAAAuB,QAAA;MAAA;IAEnC,CAAC;IAED;IACMG,qBAAqB,WAArBA,qBAAqBA,CAACtB,MAAM,EAAE;MAAA,IAAA6B,MAAA;MAAA,OAAArD,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAoD,SAAA;QAAA,IAAA7B,QAAA,EAAA8B,MAAA;QAAA,OAAAtD,mBAAA,GAAAK,IAAA,UAAAkD,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAhD,IAAA,GAAAgD,SAAA,CAAA/C,IAAA;YAAA;cAAA+C,SAAA,CAAA/C,IAAA;cAAA,OACX3C,mBAAmB,CAAC2F,kBAAkB,CAAClC,MAAM,CAAC;YAAA;cAA/DC,QAAO,GAAAgC,SAAA,CAAA7C,IAAA;cAEb,IAAI,CAACyC,MAAI,CAACrE,MAAM,CAACC,UAAU,EAAE;gBAC3BoE,MAAI,CAACrE,MAAM,CAACC,UAAS,GAAInB,OAAO,CAAC6F,IAAI,CAACN,MAAI,CAACO,KAAK,CAACC,eAAe,CAAC;cACnE;cAEMN,MAAK,GAAI;gBACbhE,KAAK,EAAE;kBACLuE,IAAI,EAAE,UAAU;kBAChBC,IAAI,EAAE,QAAQ;kBACdC,GAAG,EAAE;gBACP,CAAC;gBACDC,OAAO,EAAE;kBACPC,OAAO,EAAE;gBACX,CAAC;gBACDC,MAAM,EAAE;kBACN7F,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACM,QAAQ,CAACwF,GAAG,CAAC,UAAAC,OAAM;oBAAA,OAAKA,OAAO,CAACjG,IAAI;kBAAA,EAAC;kBACzDkG,QAAQ,EAAE7C,QAAQ,CAACnD,IAAI,CAACM,QAAQ,CAAC2F,MAAM,CAAC,UAACC,GAAG,EAAEH,OAAO,EAAK;oBACxDG,GAAG,CAACH,OAAO,CAACjG,IAAI,IAAI,IAAI;oBACxB,OAAOoG,GAAG;kBACZ,CAAC,EAAE,CAAC,CAAC,CAAC;kBACNR,GAAG,EAAE,MAAM;kBACXS,IAAI,EAAE,QAAQ;kBACdC,MAAM,EAAE,YAAY;kBACpBC,YAAY,EAAE;gBAChB,CAAC;gBACDC,IAAI,EAAE;kBACJb,IAAI,EAAE,IAAI;kBACVc,KAAK,EAAE,IAAI;kBACXC,MAAM,EAAE,IAAI;kBACZd,GAAG,EAAE,OAAO;kBACZe,YAAY,EAAE;gBAChB,CAAC;gBACDC,KAAK,EAAE;kBACLP,IAAI,EAAE,UAAU;kBAChBQ,WAAW,EAAE,KAAK;kBAClB3G,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAAC4G;gBACtB,CAAC;gBACDC,KAAK,EAAE;kBACLV,IAAI,EAAE,OAAO;kBACbrG,IAAI,EAAE,UAAU;kBAChBgH,GAAG,EAAE,EAAE;kBACPC,GAAG,EAAE;gBACP,CAAC;gBACDC,MAAM,EAAE7D,QAAQ,CAACnD,IAAI,CAACM,QAAQ,CAACwF,GAAG,CAAC,UAAAC,OAAM;kBAAA,OAAM;oBAC7CjG,IAAI,EAAEiG,OAAO,CAACjG,IAAI;oBAClBqG,IAAI,EAAE,MAAM;oBACZnG,IAAI,EAAE+F,OAAO,CAACkB,cAAc;oBAC5BC,MAAM,EAAE;kBACV,CAAC;gBAAA,CAAC;cACJ,CAAC;cAEDnC,MAAI,CAACrE,MAAM,CAACC,UAAU,CAACwG,SAAS,CAAClC,MAAM,CAAC;;cAExC;cACAF,MAAI,CAACrE,MAAM,CAACC,UAAU,CAACyG,GAAG,CAAC,OAAO,CAAC;YAAA;YAAA;cAAA,OAAAjC,SAAA,CAAArC,IAAA;UAAA;QAAA,GAAAkC,QAAA;MAAA;IACrC,CAAC;IAED;IACMN,sBAAsB,WAAtBA,sBAAsBA,CAACxB,MAAM,EAAE;MAAA,IAAAmE,MAAA;MAAA,OAAA3F,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAA0F,SAAA;QAAA,IAAAnE,QAAA,EAAAoE,KAAA,EAAAC,UAAA,EAAAC,KAAA,EAAAC,IAAA,EAAAC,SAAA,EAAAC,CAAA,EAAAC,SAAA,EAAAC,OAAA,EAAAC,cAAA,EAAAC,YAAA,EAAAC,aAAA,EAAAC,OAAA,EAAAC,aAAA,EAAAlD,MAAA;QAAA,OAAAtD,mBAAA,GAAAK,IAAA,UAAAoG,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAlG,IAAA,GAAAkG,SAAA,CAAAjG,IAAA;YAAA;cAAAiG,SAAA,CAAAlG,IAAA;cAEjCQ,OAAO,CAAC2F,GAAG,CAAC,cAAc,EAAEpF,MAAM,CAAC;cAAAmF,SAAA,CAAAjG,IAAA;cAAA,OACZ3C,mBAAmB,CAAC8I,gCAAgC,CAACrF,MAAM,CAAC;YAAA;cAA7EC,QAAO,GAAAkF,SAAA,CAAA/F,IAAA;cACbK,OAAO,CAAC2F,GAAG,CAAC,WAAW,EAAEnF,QAAQ,CAACnD,IAAI,CAAC;cAEvC,IAAI,CAACqH,MAAI,CAAC3G,MAAM,CAACE,WAAW,EAAE;gBAC5ByG,MAAI,CAAC3G,MAAM,CAACE,WAAU,GAAIpB,OAAO,CAAC6F,IAAI,CAACgC,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,CAAC;cACrE;;cAEA;cAAA,MACI,CAACrF,QAAQ,CAACnD,IAAG,IAAK,CAACmD,QAAQ,CAACnD,IAAI,CAAC0H,IAAG,IAAK,CAACvE,QAAQ,CAACnD,IAAI,CAACA,IAAG,IAAKmD,QAAQ,CAACnD,IAAI,CAAC0H,IAAI,CAACe,MAAK,KAAM,CAAC;gBAAAJ,SAAA,CAAAjG,IAAA;gBAAA;cAAA;cACjGO,OAAO,CAACC,KAAK,CAAC,WAAW,EAAEO,QAAQ,CAACnD,IAAI,CAAC;cACzC;cACAqH,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACuG,SAAS,CAAC;gBAChClG,KAAK,EAAE;kBACLuE,IAAI,EAAE,eAAe;kBACrBC,IAAI,EAAE,QAAQ;kBACdC,GAAG,EAAE;gBACP,CAAC;gBACDY,IAAI,EAAE;kBACJoC,MAAM,EAAE,KAAK;kBACbhD,GAAG,EAAE;gBACP;cACF,CAAC,CAAC;cAAA,OAAA2C,SAAA,CAAA5D,MAAA;YAAA;cAIJ;cACM8C,KAAI,GAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;cAC3EC,UAAS,GAAID,KAAK,CAACzB,GAAG,CAAC,UAAA6C,CAAA,EAAK;gBAChC,IAAMC,KAAI,GAAIC,QAAQ,CAACF,CAAC,CAAC;gBACzB,IAAMG,GAAE,GAAIF,KAAI,GAAI,CAAC;gBACrB,OAAO;kBAAEA,KAAK,EAALA,KAAK;kBAAEE,GAAE,EAAFA;gBAAI,CAAC;cACvB,CAAC,CAAC,EAEF;cACMrB,KAAI,GAAI,IAAIvH,IAAI,CAAC,CAAC;cAClBwH,IAAG,GAAI,EAAE;cACTC,SAAQ,GAAI,EAAE;cAEpB,KAASC,CAAA,GAAI,EAAE,EAAEA,CAAA,IAAK,CAAC,EAAEA,CAAA,IAAK,CAAC,EAAE;gBAC/B;gBACMC,SAAQ,GAAI,IAAI3H,IAAI,CAACuH,KAAK,CAAC;gBACjCI,SAAS,CAACkB,OAAO,CAACtB,KAAK,CAACuB,OAAO,CAAC,IAAIpB,CAAC,CAAC;;gBAEtC;gBACME,OAAM,GAAI,IAAI5H,IAAI,CAAC2H,SAAS,CAAC;gBACnCC,OAAO,CAACiB,OAAO,CAAClB,SAAS,CAACmB,OAAO,CAAC,IAAI,CAAC,CAAC;;gBAExC;gBACMjB,cAAa,GAAIF,SAAS,CAACoB,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACtDlB,YAAW,GAAIF,OAAO,CAACmB,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAExD;gBACAxB,IAAI,CAACyB,IAAI,CAACpB,cAAc,CAAC;;gBAEzB;gBACAJ,SAAS,CAACwB,IAAI,CAAC;kBACbP,KAAK,EAAEb,cAAc;kBACrBe,GAAG,EAAEd;gBACP,CAAC,CAAC;cACJ;cAEArF,OAAO,CAAC2F,GAAG,CAAC,SAAS,EAAEf,KAAK,CAACkB,MAAM,EAAE,SAAS,EAAEf,IAAI,CAACe,MAAM,EAAE,OAAO,EAAElB,KAAK,CAACkB,MAAK,GAAIf,IAAI,CAACe,MAAM,CAAC;;cAEjG;cACMR,aAAY,GAAI,GAAG,EAEzB;cACMC,OAAM,GAAI,CAAC,CAAC;cAClB/E,QAAQ,CAACnD,IAAI,CAACA,IAAI,CAACoJ,OAAO,CAAC,UAAAC,IAAG,EAAK;gBACjC,IAAIC,KAAK,CAACC,OAAO,CAACF,IAAI,KAAKA,IAAI,CAACZ,MAAK,KAAM,CAAC,EAAE;kBAC5C,IAAMe,GAAE,GAAIH,IAAI,CAAC,CAAC,CAAC;kBACnB,IAAMI,IAAG,GAAIZ,QAAQ,CAACQ,IAAI,CAAC,CAAC,CAAC,CAAC;kBAC9B,IAAMnI,KAAI,GAAIwI,UAAU,CAACL,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC;kBAEtC,IAAI,CAACM,KAAK,CAACzI,KAAK,KAAKuI,IAAG,IAAK,KAAKA,IAAG,GAAI,EAAE,EAAE;oBAC3C,IAAI,CAACvB,OAAO,CAACsB,GAAG,CAAC,EAAE;sBACjBtB,OAAO,CAACsB,GAAG,IAAI,CAAC,CAAC;oBACnB;oBACAtB,OAAO,CAACsB,GAAG,CAAC,CAACC,IAAI,IAAIvI,KAAK;kBAC5B;gBACF;cACF,CAAC,CAAC;;cAEF;cACMiH,aAAY,GAAI,EAAE;cAExBR,SAAS,CAACyB,OAAO,CAAC,UAACQ,QAAQ,EAAEC,QAAQ,EAAK;gBACxCrC,UAAU,CAAC4B,OAAO,CAAC,UAACU,SAAS,EAAEC,SAAS,EAAK;kBAC3C;kBACA,IAAIC,UAAS,GAAI,CAAC;kBAClB,IAAIC,KAAI,GAAI,CAAC;;kBAEb;kBACA,IAAMC,QAAO,GAAI,IAAIhK,IAAI,CAAC0J,QAAQ,CAAChB,KAAK,CAAC;kBACzC,IAAMuB,MAAK,GAAI,IAAIjK,IAAI,CAAC0J,QAAQ,CAACd,GAAG,CAAC;kBAErC,KAAK,IAAIsB,CAAA,GAAI,IAAIlK,IAAI,CAACgK,QAAQ,CAAC,EAAEE,CAAA,IAAKD,MAAM,EAAEC,CAAC,CAACrB,OAAO,CAACqB,CAAC,CAACpB,OAAO,CAAC,IAAI,CAAC,CAAC,EAAE;oBACxE,IAAMqB,UAAS,GAAID,CAAC,CAACnB,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;oBAEhD;oBACA,KAAK,IAAIP,CAAA,GAAImB,SAAS,CAAClB,KAAK,EAAED,CAAA,IAAKmB,SAAS,CAAChB,GAAG,EAAEH,CAAC,EAAE,EAAE;sBACrD,IAAIT,OAAO,CAACmC,UAAU,KAAKnC,OAAO,CAACmC,UAAU,CAAC,CAAC1B,CAAC,MAAM2B,SAAS,EAAE;wBAC/DN,UAAS,IAAK9B,OAAO,CAACmC,UAAU,CAAC,CAAC1B,CAAC,CAAC;wBACpCsB,KAAK,EAAE;sBACT;oBACF;kBACF;;kBAEA;kBACA,IAAMM,QAAO,GAAIN,KAAI,GAAI,IAAID,UAAS,GAAIC,KAAI,GAAI,CAAC;;kBAEnD;kBACA9B,aAAa,CAACgB,IAAI,CAAC,CAACY,SAAS,EAAEF,QAAQ,EAAEU,QAAQ,CAAC,CAAC;gBACrD,CAAC,CAAC;cACJ,CAAC,CAAC;cAEF5H,OAAO,CAAC2F,GAAG,CAAC,YAAY,EAAEH,aAAa,CAACM,MAAM,CAAC;cAC/C9F,OAAO,CAAC2F,GAAG,CAAC,YAAY,EAAEH,aAAa,CAACqC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;cAEpD;cACA7H,OAAO,CAAC2F,GAAG,CAAC,UAAU,CAAC;cACvB3F,OAAO,CAAC2F,GAAG,CAAC,WAAW,EAAEf,KAAK,CAAC;cAC/B5E,OAAO,CAAC2F,GAAG,CAAC,aAAa,EAAEZ,IAAI,CAACe,MAAM,CAAC;cACvC9F,OAAO,CAAC2F,GAAG,CAAC,WAAW,EAAEH,aAAa,CAAC,CAAC,CAAC,CAAC;cAC1C,IAAIA,aAAa,CAAC,CAAC,CAAC,EAAE;gBACpBxF,OAAO,CAAC2F,GAAG,CAAC,UAAU,EAAEH,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,EAAEZ,KAAK,CAACY,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAChFxF,OAAO,CAAC2F,GAAG,CAAC,UAAU,EAAEH,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,EAAET,IAAI,CAACS,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC/ExF,OAAO,CAAC2F,GAAG,CAAC,SAAS,EAAEH,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;cAC7C;cAEMlD,MAAK,GAAI;gBACbwF,SAAS,EAAE,KAAK;gBAAG;gBACnBxJ,KAAK,EAAE;kBACLuE,IAAI,EAAE,SAAS;kBACfC,IAAI,EAAE,QAAQ;kBACdC,GAAG,EAAE;gBACP,CAAC;gBACDC,OAAO,EAAE;kBACP+E,QAAQ,EAAE,KAAK;kBACfC,SAAS,EAAE,SAAXA,SAASA,CAAYzH,MAAM,EAAE;oBAC3B,IAAM6G,SAAQ,GAAI7G,MAAM,CAAClD,IAAI,CAAC,CAAC,CAAC;oBAChC,IAAM4K,SAAQ,GAAIrD,KAAK,CAACwC,SAAS,CAAC;oBAClC,IAAMc,OAAM,GAAIhC,QAAQ,CAAC+B,SAAS,IAAI,CAAC;oBACvC,IAAMf,QAAO,GAAI3G,MAAM,CAAClD,IAAI,CAAC,CAAC,CAAC;oBAC/B,IAAMwJ,GAAE,GAAI9B,IAAI,CAACmC,QAAQ,CAAC;oBAC1B,IAAMiB,OAAM,GAAInD,SAAS,CAACkC,QAAQ,CAAC,CAACf,GAAG;oBACvC,IAAM5H,KAAI,GAAIgC,MAAM,CAAClD,IAAI,CAAC,CAAC,CAAC;oBAC5B,8BAAA+K,MAAA,CAAeH,SAAS,UAAAG,MAAA,CAAOF,OAAO,2BAAAE,MAAA,CAAcvB,GAAG,cAAAuB,MAAA,CAAMD,OAAO,wBAAAC,MAAA,CAAW7J,KAAK,CAACuC,OAAO,CAAC,CAAC,CAAC;kBACjG;gBACF,CAAC;gBACD6C,IAAI,EAAE;kBACJoC,MAAM,EAAE,KAAK;kBACbhD,GAAG,EAAE,MAAM;kBACXD,IAAI,EAAE,MAAM;kBACZc,KAAK,EAAE;gBACT,CAAC;gBACDG,KAAK,EAAE;kBACLP,IAAI,EAAE,UAAU;kBAChBnG,IAAI,EAAEuH,KAAK;kBACXyD,SAAS,EAAE;oBACTC,IAAI,EAAE;kBACR,CAAC;kBACDC,SAAS,EAAE;oBACTP,SAAS,EAAE;kBACb;gBACF,CAAC;gBACD9D,KAAK,EAAE;kBACLV,IAAI,EAAE,UAAU;kBAChBnG,IAAI,EAAE0H,IAAI;kBACVsD,SAAS,EAAE;oBACTC,IAAI,EAAE;kBACR,CAAC;kBACDC,SAAS,EAAE;oBACTP,SAAS,EAAE,SAAXA,SAASA,CAAYzJ,KAAK,EAAE;sBAC1B;sBACA,IAAMiK,KAAI,GAAIjK,KAAK,CAACgI,KAAK,CAAC,GAAG,CAAC;sBAC9B,OAAOiC,KAAK,CAAC,CAAC,IAAI,GAAE,GAAIA,KAAK,CAAC,CAAC,CAAC;oBAClC;kBACF;gBACF,CAAC;gBACDC,SAAS,EAAE;kBACTjF,IAAI,EAAE,YAAY;kBAClBW,GAAG,EAAE,CAAC;kBACNC,GAAG,EAAEkB,aAAa;kBAClBoD,UAAU,EAAE,KAAK;kBAAE;kBACnBC,QAAQ,EAAE,KAAK;kBAAI;kBACnBlF,MAAM,EAAE,YAAY;kBACpBX,IAAI,EAAE,QAAQ;kBACde,MAAM,EAAE,IAAI;kBACZ+E,OAAO,EAAE;oBACPC,KAAK,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS;kBACjI,CAAC;kBACDhG,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;kBAAM;kBACtBiG,SAAS,EAAE,EAAE;kBAAU;kBACvBC,UAAU,EAAE,GAAG;kBAAQ;kBACvBC,SAAS,EAAE,EAAY;gBACzB,CAAC;gBACD3E,MAAM,EAAE,CAAC;kBACPlH,IAAI,EAAE,UAAU;kBAChBqG,IAAI,EAAE,SAAS;kBACfnG,IAAI,EAAEmI,aAAa;kBACnByD,KAAK,EAAE;oBACLX,IAAI,EAAE;kBACR,CAAC;kBACDY,QAAQ,EAAE;oBACRC,SAAS,EAAE;sBACTC,UAAU,EAAE,EAAE;sBACdC,WAAW,EAAE;oBACf;kBACF;gBACF,CAAC;cACH,CAAC,EAED;cACA,IAAI;gBACF;gBACA,IAAI3E,MAAI,CAAC3G,MAAM,CAACE,WAAW,EAAE;kBAC3ByG,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACqL,OAAO,CAAC,CAAC;gBACnC;;gBAEA;gBACA,IAAI5E,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,EAAE;kBAC/B;kBACAnB,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,CAAC0D,KAAK,CAACC,KAAI,GAAI,MAAM;kBAChD9E,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,CAAC0D,KAAK,CAACxD,MAAK,GAAI,OAAO,EAAG;;kBAErD;kBACArB,MAAI,CAAC3G,MAAM,CAACE,WAAU,GAAIpB,OAAO,CAAC6F,IAAI,CAACgC,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,CAAC;;kBAEnE;kBACAnB,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACuG,SAAS,CAAClC,MAAM,EAAE,IAAI,CAAC;kBAC/CtC,OAAO,CAAC2F,GAAG,CAAC,SAAS,CAAC;;kBAEtB;kBACAjB,MAAI,CAAC+E,SAAS,CAAC,YAAM;oBACnB,IAAI/E,MAAI,CAAC3G,MAAM,CAACE,WAAW,EAAE;sBAC3ByG,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACyL,MAAM,CAAC,CAAC;oBAClC;kBACF,CAAC,CAAC;;kBAEF;kBACAhF,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACwG,GAAG,CAAC,OAAO,CAAC;gBACtC,OAAO;kBACLzE,OAAO,CAACC,KAAK,CAAC,aAAa,CAAC;gBAC9B;cACF,EAAE,OAAO0J,UAAU,EAAE;gBACnB3J,OAAO,CAACC,KAAK,CAAC,YAAY,EAAE0J,UAAU,CAAC;gBACvC3J,OAAO,CAACC,KAAK,CAAC,OAAO,EAAE0J,UAAU,CAACC,KAAK,CAAC;gBACxC;gBACA,IAAIlF,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,EAAE;kBAC/B,IAAInB,MAAI,CAAC3G,MAAM,CAACE,WAAW,EAAE;oBAC3ByG,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACqL,OAAO,CAAC,CAAC;kBACnC;kBACA5E,MAAI,CAAC3G,MAAM,CAACE,WAAU,GAAIpB,OAAO,CAAC6F,IAAI,CAACgC,MAAI,CAAC/B,KAAK,CAACkD,gBAAgB,CAAC;kBACnEnB,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACuG,SAAS,CAAC;oBAChClG,KAAK,EAAE;sBACLuE,IAAI,EAAE,gBAAgB;sBACtBgH,SAAS,EAAE;wBACThB,KAAK,EAAE;sBACT,CAAC;sBACD/F,IAAI,EAAE,QAAQ;sBACdC,GAAG,EAAE;oBACP;kBACF,CAAC,CAAC;gBACJ;cACF;cAAA2C,SAAA,CAAAjG,IAAA;cAAA;YAAA;cAAAiG,SAAA,CAAAlG,IAAA;cAAAkG,SAAA,CAAA3F,EAAA,GAAA2F,SAAA;cAEA1F,OAAO,CAACC,KAAK,CAAC,cAAc,EAAAyF,SAAA,CAAA3F,EAAO,CAAC;cACpCC,OAAO,CAACC,KAAK,CAAC,OAAO,EAAEyF,SAAA,CAAA3F,EAAA,CAAM6J,KAAK,CAAC;cACnC;cACA,IAAIlF,MAAI,CAAC3G,MAAM,CAACE,WAAW,EAAE;gBAC3ByG,MAAI,CAAC3G,MAAM,CAACE,WAAW,CAACuG,SAAS,CAAC;kBAChClG,KAAK,EAAE;oBACLuE,IAAI,EAAE,gBAAgB;oBACtBgH,SAAS,EAAE;sBACThB,KAAK,EAAE;oBACT,CAAC;oBACD/F,IAAI,EAAE,QAAQ;oBACdC,GAAG,EAAE;kBACP;gBACF,CAAC,CAAC;cACJ;YAAA;YAAA;cAAA,OAAA2C,SAAA,CAAAvF,IAAA;UAAA;QAAA,GAAAwE,QAAA;MAAA;IAEJ,CAAC;IAED;IACM3C,sBAAsB,WAAtBA,sBAAsBA,CAACzB,MAAM,EAAE;MAAA,IAAAuJ,MAAA;MAAA,OAAA/K,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAA8K,SAAA;QAAA,IAAAvJ,QAAA,EAAA8B,MAAA;QAAA,OAAAtD,mBAAA,GAAAK,IAAA,UAAA2K,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAzK,IAAA,GAAAyK,SAAA,CAAAxK,IAAA;YAAA;cAAAwK,SAAA,CAAAxK,IAAA;cAAA,OACZ3C,mBAAmB,CAACoN,qBAAqB,CAAC3J,MAAM,CAAC;YAAA;cAAlEC,QAAO,GAAAyJ,SAAA,CAAAtK,IAAA;cAEb,IAAI,CAACmK,MAAI,CAAC/L,MAAM,CAACG,WAAW,EAAE;gBAC5B4L,MAAI,CAAC/L,MAAM,CAACG,WAAU,GAAIrB,OAAO,CAAC6F,IAAI,CAACoH,MAAI,CAACnH,KAAK,CAACwH,gBAAgB,CAAC;cACrE;cAEM7H,MAAK,GAAI;gBACbhE,KAAK,EAAE;kBACLuE,IAAI,EAAE;gBACR,CAAC;gBACDG,OAAO,EAAE;kBACPC,OAAO,EAAE,MAAM;kBACfmH,WAAW,EAAE;oBACX5G,IAAI,EAAE;kBACR;gBACF,CAAC;gBACDN,MAAM,EAAE;kBACN7F,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;kBACtCqG,YAAY,EAAE;gBAChB,CAAC;gBACDC,IAAI,EAAE;kBACJb,IAAI,EAAE,IAAI;kBACVc,KAAK,EAAE,IAAI;kBACXC,MAAM,EAAE,IAAI;kBACZC,YAAY,EAAE;gBAChB,CAAC;gBACDC,KAAK,EAAE;kBACLP,IAAI,EAAE,OAAO;kBACbrG,IAAI,EAAE,IAAI;kBACViH,GAAG,EAAE;gBACP,CAAC;gBACDF,KAAK,EAAE;kBACLV,IAAI,EAAE,UAAU;kBAChBnG,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAAC8F,GAAG,CAAC,UAAAuD,IAAG;oBAAA,OAAKA,IAAI,CAAC2D,WAAW;kBAAA;gBAClD,CAAC;gBACDhG,MAAM,EAAE,CACN;kBACElH,IAAI,EAAE,MAAM;kBACZqG,IAAI,EAAE,KAAK;kBACXoG,KAAK,EAAE,OAAO;kBACdX,KAAK,EAAE;oBACLX,IAAI,EAAE;kBACR,CAAC;kBACDY,QAAQ,EAAE;oBACRoB,KAAK,EAAE;kBACT,CAAC;kBACDjN,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAAC8F,GAAG,CAAC,UAAAuD,IAAG;oBAAA,OAAKA,IAAI,CAAC6D,SAAS;kBAAA;gBAChD,CAAC,EACD;kBACEpN,IAAI,EAAE,MAAM;kBACZqG,IAAI,EAAE,KAAK;kBACXoG,KAAK,EAAE,OAAO;kBACdX,KAAK,EAAE;oBACLX,IAAI,EAAE;kBACR,CAAC;kBACDY,QAAQ,EAAE;oBACRoB,KAAK,EAAE;kBACT,CAAC;kBACDjN,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAAC8F,GAAG,CAAC,UAAAuD,IAAG;oBAAA,OAAKA,IAAI,CAAC8D,SAAS;kBAAA;gBAChD,CAAC,EACD;kBACErN,IAAI,EAAE,MAAM;kBACZqG,IAAI,EAAE,KAAK;kBACXoG,KAAK,EAAE,OAAO;kBACdX,KAAK,EAAE;oBACLX,IAAI,EAAE;kBACR,CAAC;kBACDY,QAAQ,EAAE;oBACRoB,KAAK,EAAE;kBACT,CAAC;kBACDjN,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAAC8F,GAAG,CAAC,UAAAuD,IAAG;oBAAA,OAAKA,IAAI,CAAC+D,gBAAgB;kBAAA;gBACvD,CAAC,EACD;kBACEtN,IAAI,EAAE,MAAM;kBACZqG,IAAI,EAAE,KAAK;kBACXoG,KAAK,EAAE,OAAO;kBACdX,KAAK,EAAE;oBACLX,IAAI,EAAE;kBACR,CAAC;kBACDY,QAAQ,EAAE;oBACRoB,KAAK,EAAE;kBACT,CAAC;kBACDjN,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAAC8F,GAAG,CAAC,UAAAuD,IAAG;oBAAA,OAAKA,IAAI,CAACgE,UAAU;kBAAA;gBACjD;cAEJ,CAAC;cAEDZ,MAAI,CAAC/L,MAAM,CAACG,WAAW,CAACsG,SAAS,CAAClC,MAAM,CAAC;;cAEzC;cACAwH,MAAI,CAAC/L,MAAM,CAACG,WAAW,CAACuG,GAAG,CAAC,OAAO,CAAC;YAAA;YAAA;cAAA,OAAAwF,SAAA,CAAA9J,IAAA;UAAA;QAAA,GAAA4J,QAAA;MAAA;IACtC,CAAC;IAED;IACM9H,gBAAgB,WAAhBA,gBAAgBA,CAAC1B,MAAM,EAAE;MAAA,IAAAoK,MAAA;MAAA,OAAA5L,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAA2L,SAAA;QAAA,IAAApK,QAAA,EAAA8B,MAAA;QAAA,OAAAtD,mBAAA,GAAAK,IAAA,UAAAwL,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAtL,IAAA,GAAAsL,SAAA,CAAArL,IAAA;YAAA;cAAAqL,SAAA,CAAArL,IAAA;cAAA,OACN3C,mBAAmB,CAACiO,wBAAwB,CAACxK,MAAM,CAAC;YAAA;cAArEC,QAAO,GAAAsK,SAAA,CAAAnL,IAAA;cAEb,IAAI,CAACgL,MAAI,CAAC5M,MAAM,CAACI,KAAK,EAAE;gBACtBwM,MAAI,CAAC5M,MAAM,CAACI,KAAI,GAAItB,OAAO,CAAC6F,IAAI,CAACiI,MAAI,CAAChI,KAAK,CAACqI,UAAU,CAAC;cACzD;cAEM1I,MAAK,GAAI;gBACbhE,KAAK,EAAE;kBACLuE,IAAI,EAAE;gBACR,CAAC;gBACDG,OAAO,EAAE;kBACPC,OAAO,EAAE;gBACX,CAAC;gBACDC,MAAM,EAAE;kBACN7F,IAAI,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC;kBAClCqG,YAAY,EAAE;gBAChB,CAAC;gBACDC,IAAI,EAAE;kBACJb,IAAI,EAAE,IAAI;kBACVc,KAAK,EAAE,IAAI;kBACXC,MAAM,EAAE,IAAI;kBACZC,YAAY,EAAE;gBAChB,CAAC;gBACDC,KAAK,EAAE,CACL;kBACEP,IAAI,EAAE,UAAU;kBAChBnG,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACO,MAAM,CAACuF,GAAG,CAAC,UAAAhF,KAAI;oBAAA,OAAKA,KAAK,CAAChB,IAAI;kBAAA,EAAC;kBACnDiN,WAAW,EAAE;oBACX5G,IAAI,EAAE;kBACR;gBACF,EACD;gBACDU,KAAK,EAAE,CACL;kBACEV,IAAI,EAAE,OAAO;kBACbrG,IAAI,EAAE,IAAI;kBACVgH,GAAG,EAAE,CAAC;kBACNoE,SAAS,EAAE;oBACTP,SAAS,EAAE;kBACb;gBACF,CAAC,EACD;kBACExE,IAAI,EAAE,OAAO;kBACbrG,IAAI,EAAE,SAAS;kBACfgH,GAAG,EAAE,CAAC;kBACNoE,SAAS,EAAE;oBACTP,SAAS,EAAE;kBACb;gBACF,EACD;gBACD3D,MAAM,EAAE,CACN;kBACElH,IAAI,EAAE,MAAM;kBACZqG,IAAI,EAAE,KAAK;kBACXnG,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACO,MAAM,CAACuF,GAAG,CAAC,UAAAhF,KAAI;oBAAA,OAAKA,KAAK,CAAC8M,aAAa;kBAAA;gBAC7D,CAAC,EACD;kBACE9N,IAAI,EAAE,QAAQ;kBACdqG,IAAI,EAAE,MAAM;kBACZ0H,UAAU,EAAE,CAAC;kBACb7N,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACO,MAAM,CAACuF,GAAG,CAAC,UAAAhF,KAAI;oBAAA,OAAKA,KAAK,CAACgN,mBAAmB;kBAAA;gBACnE,CAAC,EACD;kBACEhO,IAAI,EAAE,QAAQ;kBACdqG,IAAI,EAAE,MAAM;kBACZ0H,UAAU,EAAE,CAAC;kBACb7N,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACO,MAAM,CAACuF,GAAG,CAAC,UAAAhF,KAAI;oBAAA,OAAKA,KAAK,CAACiN,cAAc;kBAAA;gBAC9D;cAEJ,CAAC;cAEDT,MAAI,CAAC5M,MAAM,CAACI,KAAK,CAACqG,SAAS,CAAClC,MAAM,CAAC;;cAEnC;cACAqI,MAAI,CAAC5M,MAAM,CAACI,KAAK,CAACsG,GAAG,CAAC,OAAO,CAAC;YAAA;YAAA;cAAA,OAAAqG,SAAA,CAAA3K,IAAA;UAAA;QAAA,GAAAyK,QAAA;MAAA;IAChC,CAAC;IAED;IACM1I,eAAe,WAAfA,eAAeA,CAAC3B,MAAM,EAAE;MAAA,IAAA8K,MAAA;MAAA,OAAAtM,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAqM,SAAA;QAAA,IAAA9K,QAAA,EAAA8B,MAAA;QAAA,OAAAtD,mBAAA,GAAAK,IAAA,UAAAkM,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAhM,IAAA,GAAAgM,SAAA,CAAA/L,IAAA;YAAA;cAAA+L,SAAA,CAAA/L,IAAA;cAAA,OACL3C,mBAAmB,CAAC2O,uBAAuB,CAAClL,MAAM,CAAC;YAAA;cAApEC,QAAO,GAAAgL,SAAA,CAAA7L,IAAA;cAEb,IAAI,CAAC0L,MAAI,CAACtN,MAAM,CAACK,IAAI,EAAE;gBACrBiN,MAAI,CAACtN,MAAM,CAACK,IAAG,GAAIvB,OAAO,CAAC6F,IAAI,CAAC2I,MAAI,CAAC1I,KAAK,CAAC+I,SAAS,CAAC;cACvD;cAEMpJ,MAAK,GAAI;gBACbhE,KAAK,EAAE;kBACLuE,IAAI,EAAE;gBACR,CAAC;gBACDG,OAAO,EAAE;kBACPC,OAAO,EAAE,MAAM;kBACfmH,WAAW,EAAE;oBACX5G,IAAI,EAAE;kBACR;gBACF,CAAC;gBACDN,MAAM,EAAE;kBACN7F,IAAI,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;kBACzBqG,YAAY,EAAE;gBAChB,CAAC;gBACDC,IAAI,EAAE;kBACJb,IAAI,EAAE,IAAI;kBACVc,KAAK,EAAE,IAAI;kBACXC,MAAM,EAAE,IAAI;kBACZC,YAAY,EAAE;gBAChB,CAAC;gBACDC,KAAK,EAAE,CACL;kBACEP,IAAI,EAAE,UAAU;kBAChBnG,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC;kBACzGkL,SAAS,EAAE;oBACTP,SAAS,EAAE;kBACb;gBACF,EACD;gBACD9D,KAAK,EAAE,CACL;kBACEV,IAAI,EAAE,OAAO;kBACbrG,IAAI,EAAE,KAAK;kBACXgH,GAAG,EAAE,CAAC;kBACNoE,SAAS,EAAE;oBACTP,SAAS,EAAE;kBACb;gBACF,CAAC,EACD;kBACExE,IAAI,EAAE,OAAO;kBACbrG,IAAI,EAAE,WAAW;kBACjBgH,GAAG,EAAE,CAAC;kBACNoE,SAAS,EAAE;oBACTP,SAAS,EAAE;kBACb;gBACF,EACD;gBACD3D,MAAM,EAAE,CACN;kBACElH,IAAI,EAAE,OAAO;kBACbqG,IAAI,EAAE,KAAK;kBACXnG,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACsO;gBACtB,CAAC,EACD;kBACExO,IAAI,EAAE,QAAQ;kBACdqG,IAAI,EAAE,MAAM;kBACZ0H,UAAU,EAAE,CAAC;kBACb7N,IAAI,EAAEmD,QAAQ,CAACnD,IAAI,CAACuO;gBACtB;cAEJ,CAAC;cAEDP,MAAI,CAACtN,MAAM,CAACK,IAAI,CAACoG,SAAS,CAAClC,MAAM,CAAC;;cAElC;cACA+I,MAAI,CAACtN,MAAM,CAACK,IAAI,CAACqG,GAAG,CAAC,OAAO,CAAC;YAAA;YAAA;cAAA,OAAA+G,SAAA,CAAArL,IAAA;UAAA;QAAA,GAAAmL,QAAA;MAAA;IAC/B,CAAC;IAED;IACA3K,eAAe,WAAfA,eAAeA,CAAA,EAAG;MAChB,OAAO;QACLuE,SAAS,EAAE,IAAI,CAAC5H,SAAS,CAAC,CAAC,IAAI,IAAI,CAACA,SAAS,CAAC,CAAC,CAAC,CAACgJ,WAAW,CAAC,IAAI,IAAI;QACrEnB,OAAO,EAAE,IAAI,CAAC7H,SAAS,CAAC,CAAC,IAAI,IAAI,CAACA,SAAS,CAAC,CAAC,CAAC,CAACgJ,WAAW,CAAC,IAAI,IAAI;QACnEuF,UAAU,EAAE,IAAI,CAACpO,gBAAgB,CAACqI,MAAK,GAAI,IAAI,IAAI,CAACrI,gBAAe,GAAI,IAAI;QAC3EqO,QAAQ,EAAE,IAAI,CAACpO,cAAc,CAACoI,MAAK,GAAI,IAAI,IAAI,CAACpI,cAAa,GAAI;MACnE,CAAC;IACH,CAAC;IAED;IACAqO,iBAAiB,WAAjBA,iBAAiBA,CAACC,SAAS,EAAE;MAC3B,IAAMC,MAAK,GAAI;QACbjO,UAAU,EAAE,UAAU;QACtBC,WAAW,EAAE,SAAS;QACtBC,WAAW,EAAE,UAAU;QACvBC,KAAK,EAAE,WAAW;QAClBC,IAAI,EAAE;MACR,CAAC;MAED,IAAI,CAACN,iBAAgB,GAAImO,MAAM,CAACD,SAAS,CAAC;MAC1C,IAAI,CAAClM,cAAc,CAAC,CAAC;IACvB;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}